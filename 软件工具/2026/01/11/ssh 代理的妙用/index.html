
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录一些关于数学、计算机的知识，以及一些日常。">
      
      
      
        <link rel="canonical" href="https://yfy.cqu.ai/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/2026/01/11/ssh%20%E4%BB%A3%E7%90%86%E7%9A%84%E5%A6%99%E7%94%A8/">
      
      
        <link rel="prev" href="../../../../../%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/2025/10/27/%E9%9B%B6%E6%88%90%E6%9C%AC%E9%83%A8%E7%BD%B2%E5%A4%9A%E4%BA%BA%20Gemini%20Pro%20AI%20%E6%9C%8D%E5%8A%A1/">
      
      
        <link rel="next" href="../../../../../%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/2026/01/25/%E5%8F%8C%E5%AE%BD%E5%B8%A6%E4%B8%8A%E4%BC%A0%E5%8F%A0%E5%8A%A0%EF%BC%8C%E5%AE%9E%E7%8E%B0%E5%BC%82%E5%9C%B0%204K%20%E4%B8%B2%E6%B5%81/">
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>ssh 代理的妙用 - Rain 的随笔</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ssh-正向和反向代理总结" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="Rain 的随笔" class="md-header__button md-logo" aria-label="Rain 的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rain 的随笔
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ssh 代理的妙用
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  博客

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../about/" class="md-tabs__link">
        
  
  
    
  
  关于

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tags/" class="md-tabs__link">
        
  
  
    
  
  标签

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../series/" class="md-tabs__link">
        
  
  
    
  
  系列

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tools/" class="md-tabs__link">
        
  
  
    
  
  工具

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../archive/2026/" class="md-tabs__link">
          
  
  
  归档

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../category/%E4%B8%AA%E4%BA%BA/" class="md-tabs__link">
          
  
  
  分类

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Rain 的随笔" class="md-nav__button md-logo" aria-label="Rain 的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Rain 的随笔
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    博客
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    关于
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    标签
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    系列
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    工具
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    归档
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    归档
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2026/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2026
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2021/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2021
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2019/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2019
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    分类
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    分类
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E4%B8%AA%E4%BA%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    个人
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%8D%9A%E5%AE%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    博客
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%8D%9A%E5%AE%A2--%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    博客 &amp; 网络
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    学习笔记
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    折腾记录
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    课程笔记
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    软件工具
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E9%98%85%E8%AF%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    阅读
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2026-01-11 01:12:20+00:00" class="md-ellipsis">2026年1月11日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../../../../category/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/">软件工具</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 5 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ssh-正向和反向代理总结" class="md-nav__link">
    <span class="md-ellipsis">
      
        ssh 正向和反向代理总结
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ssh 正向和反向代理总结">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#正向代理" class="md-nav__link">
    <span class="md-ellipsis">
      
        正向代理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#反向代理" class="md-nav__link">
    <span class="md-ellipsis">
      
        反向代理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonussocks-代理任意流量" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bonus：SOCKS 代理任意流量
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#优化选项" class="md-nav__link">
    <span class="md-ellipsis">
      
        优化选项
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-使用示例收集" class="md-nav__link">
    <span class="md-ellipsis">
      
        ssh 使用示例收集
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ssh 使用示例收集">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#正向代理_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        正向代理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="正向代理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#访问远程-localhost-服务" class="md-nav__link">
    <span class="md-ellipsis">
      
        访问远程 localhost 服务
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jumpssh-跳板机" class="md-nav__link">
    <span class="md-ellipsis">
      
        jump——ssh 跳板机
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#反向代理_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        反向代理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="反向代理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#内网服务器使用本地上网" class="md-nav__link">
    <span class="md-ellipsis">
      
        内网服务器使用本地上网
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#借用-vps-公网-v4-暴露本地服务" class="md-nav__link">
    <span class="md-ellipsis">
      
        借用 VPS 公网 v4 暴露本地服务
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#代理公司内网" class="md-nav__link">
    <span class="md-ellipsis">
      
        代理公司内网
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gost" class="md-nav__link">
    <span class="md-ellipsis">
      
        gost
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="gost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#基本命令" class="md-nav__link">
    <span class="md-ellipsis">
      
        基本命令
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#用例" class="md-nav__link">
    <span class="md-ellipsis">
      
        用例
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="用例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vps-代理本地-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      
        VPS 代理本地 ssh
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#内网服务器使用本地上网_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        内网服务器使用本地上网
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
      
        <a href="../../../../../tags/#tag:gost" class="md-tag">gost</a>
      
    
      
      
      
      
        <a href="../../../../../tags/#tag:proxy" class="md-tag">proxy</a>
      
    
      
      
      
      
        <a href="../../../../../tags/#tag:socks" class="md-tag">socks</a>
      
    
      
      
      
      
        <a href="../../../../../tags/#tag:ssh" class="md-tag">ssh</a>
      
    
  </nav>



  <h1>ssh 代理的妙用</h1>

<p>起因是需要让阿里云 ecs 访问 github，在使用 ssh -R 完成需求后，仔细研究了 ssh -L/-R 的区别。在搞明白后，觉得它们是如此的对称，设计的太好了。后面又发现了gost 这个代理领域的”瑞士军刀“，将它和 ssh 正反代理结合，真的是可以玩出花了。</p>
<!-- more -->

<h2 id="ssh-正向和反向代理总结">ssh 正向和反向代理总结<a class="headerlink" href="#ssh-正向和反向代理总结" title="Permanent link">&para;</a></h2>
<p>本质就是 ssh 在两台机器间建立了一个安全隧道（secure channel），ssh <code>-L/-R</code> 使用 ssh 隧道，<strong>实现在本地的和远程之间的 socket 转发</strong>。</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w"> </span>-L/R<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port<span class="w">  </span>:<span class="w">  </span>host:hostport
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">       </span>socket1<span class="w">                 </span>socket2
</span></code></pre></div>
<ul>
<li>socket 支持 TCP （ip 和 端口） 和 Unix socket</li>
<li>-L（-R） 实现本地（远程）监听一个 socket，远程（本地）对指定的 host:hostport 建立一个 TCP 连接，ssh 在这两个 socket 之间转发数据</li>
</ul>
<h3 id="正向代理">正向代理<a class="headerlink" href="#正向代理" title="Permanent link">&para;</a></h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="w"> </span>-L<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port:host:hostport
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w"> </span>-L<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port:remote_socket
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w"> </span>-L<span class="w"> </span>local_socket:host:hostport
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w"> </span>-L<span class="w"> </span>local_socket:remote_socket
</span></code></pre></div>
<ul>
<li><code>[bind_address:]port</code> 表示本地监听的 socket，发送给这个 socket 的数据，会被转发到远程的 socket <code>host:hostport</code>（由远程机器连接创建）</li>
<li>本地监听的 socket
    - 不指定 bind_address 时，一般是绑定到 localhost（<code>GatewayPorts</code> 默认 <code>no</code>，绑定到 local），只有本机可以访问。
    - 设置为<code>空</code>或者 <code>*</code> 时，绑定到所有地址（v4：<code>0.0.0.0</code> , v6：<code>[::]</code>）
    - By default, the local port is bound in accordance with the GatewayPorts setting.  However, an explicit bind_address may be used to bind the connection to a specific address.  The bind_address of <code>localhost</code> indicates that the listening port be bound for local use only, while an empty address or <code>*</code> indicates that the port should be available from all interfaces.</li>
</ul>
<h3 id="反向代理">反向代理<a class="headerlink" href="#反向代理" title="Permanent link">&para;</a></h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>-R<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port:host:hostport
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>-R<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port:local_socket
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>-R<span class="w"> </span>remote_socket:host:hostport
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>-R<span class="w"> </span>remote_socket:local_socket
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>-R<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port
</span></code></pre></div>
<ul>
<li><code>[bind_address:]port</code> 和 <code>host:hostport</code> 表示的远程和本地刚好对调了一下，<code>[bind_address:]port</code> 此时表示远程机器上监听的端口。</li>
<li>默认绑定到 loopback 接口（127.0.0.1）。想要绑定到任意接口只有远程 sshd <code>GatewayPorts</code> 启用才行（启用时默认绑定到 0.0.0.0）。</li>
</ul>
<h3 id="bonussocks-代理任意流量">Bonus：SOCKS 代理任意流量<a class="headerlink" href="#bonussocks-代理任意流量" title="Permanent link">&para;</a></h3>
<p>ssh -L 可以实现让远程代理特定 ip 和 端口流量，有没有办法代理任意地址流量呢。</p>
<p>ssh 支持 -D 选项</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>-D<span class="w"> </span><span class="o">[</span>bind_address:<span class="o">]</span>port
</span></code></pre></div>
<ul>
<li>简单来说就是在本地监听 <code>[bind_address:]port</code>，启动一个 socks 代理服务。</li>
<li>socks 代理任意流量的原理：1）socks 客户端请求 socks 服务器，告诉需要连接目的地址。2）socks 服务器和目的地址建立连接，之后在两个 socket 之间转发 TCP 流量。</li>
<li>支持 SOCKS4/SOCKS5 协议<ul>
<li>SOCKS5 支持代理 UDP：1）客户端首先通过 <strong>TCP</strong> 连接到 SOCKS5 服务器，发送一个 <code>UDP ASSOCIATE</code> 请求。服务器会告诉客户端：“我已经准备好了“。2）客户端将原始的 UDP 数据包封装（加上 SOCKS5 特有的报头），然后通过 <strong>UDP</strong> 协议发送到服务器指定的端口。服务器收到后，剥离报头，再将原始 UDP 数据转发给最终的目标。</li>
</ul>
</li>
<li>Specifies a local “dynamic” application-level port forwarding.  This works by allocating a socket to listen to port on the local side, optionally bound to the specified bind_address.  Whenever a connection is made to this port, the connection is forwarded over the secure channel, and the application protocol is then used to determine where to connect to from the remote machine.</li>
</ul>
<p>ssh -R 也有一个<strong>动态远程端口转发</strong>的功能，和 -D 的区别是 -R 是在<strong>远程</strong>监听 socks 服务，将流量通过本地转发。<strong>可以一条命令实现让远程服务器通过本地机器代理上网</strong>，对于远程服务器没法访问外网（比如国内 ecs 没法访问 github）很方便。</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># in local machine</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>ssh<span class="w"> </span>-R<span class="w"> </span><span class="m">11223</span><span class="w"> </span>server
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># in server</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">all_proxy</span><span class="o">=</span>socks5h://127.0.0.1:11223
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c1"># sock5h 表示通过代理进行 dns 解析</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>curl<span class="w"> </span>-L<span class="w"> </span>-O
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1"># wget 不支持 socks 代理</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;">参数</th>
<th style="text-align: left;">命令示例</th>
<th style="text-align: left;">代理类型</th>
<th style="text-align: left;">监听位置</th>
<th style="text-align: left;">流量出口 (IP变成谁)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>-D</strong></td>
<td style="text-align: left;"><code>ssh -D 1080 B</code></td>
<td style="text-align: left;">动态本地转发</td>
<td style="text-align: left;">本地 (A)</td>
<td style="text-align: left;">远程 (B)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>-R</strong> (完整)</td>
<td style="text-align: left;"><code>ssh -R 8080:1.2.3.4:80 B</code></td>
<td style="text-align: left;">静态远程转发</td>
<td style="text-align: left;">远程 (B)</td>
<td style="text-align: left;">本地 (A) -&gt; 固定目标</td>
</tr>
<tr>
<td style="text-align: left;"><strong>-R</strong> (简写)</td>
<td style="text-align: left;"><code>ssh -R 1080 B</code></td>
<td style="text-align: left;"><strong>动态远程转发</strong></td>
<td style="text-align: left;"><strong>远程 (B)</strong></td>
<td style="text-align: left;"><strong>本地 (A) -&gt; 任意目标</strong></td>
</tr>
</tbody>
</table>
<h3 id="优化选项">优化选项<a class="headerlink" href="#优化选项" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>-N (No Command)</strong>：告诉 SSH 只建立连接，不执行远程命令（即不打开 Shell 终端）。<ul>
<li>你只想用它做隧道，不需要终端交互，设置此项可以防止误操作。</li>
</ul>
</li>
<li><strong>-f (Background)</strong>：让 SSH 在后台运行。<ul>
<li>输入密码连接成功后，SSH 会立即进入后台，释放当前终端窗口。通常与 -N 配合使用。</li>
</ul>
</li>
<li><strong>-q (Quiet)</strong>：静默模式。<ul>
<li>减少不必要的输出日志。</li>
</ul>
</li>
<li><strong>-C (Compression)</strong>：开启压缩。
    - <strong>开启</strong>：如果你在低速网络（如跨国 VPS、手机热点）上运行。
    - <strong>关闭</strong>：如果你在局域网内，或者传输的是已经压缩过的文件（如 JPG, ZIP, 视频），开启压缩反而会增加 CPU 负载并降低速度。</li>
<li><strong>-o ServerAliveInterval=30</strong>：客户端每隔 30 秒向服务器发送一个“心跳”包。</li>
<li><strong>-o ServerAliveCountMax=3</strong>：如果连续 3 次心跳包没有回应，则强制断开连接并退出。</li>
<li><strong>-o ExitOnForwardFailure=yes</strong>：如果端口转发绑定失败（例如端口已被占用），直接退出程序。<ul>
<li>原因：默认情况下，如果转发失败，SSH 仍会保持连接，这会导致你以为代理通了其实没通。</li>
</ul>
</li>
</ul>
<p>Tips 临时使用，通常开启 <code>-N -C</code> 即可</p>
<h2 id="ssh-使用示例收集">ssh 使用示例收集<a class="headerlink" href="#ssh-使用示例收集" title="Permanent link">&para;</a></h2>
<h3 id="正向代理_1">正向代理<a class="headerlink" href="#正向代理_1" title="Permanent link">&para;</a></h3>
<h4 id="访问远程-localhost-服务">访问远程 localhost 服务<a class="headerlink" href="#访问远程-localhost-服务" title="Permanent link">&para;</a></h4>
<p>一些服务为了安全，会监听 localhost，只有本机可以访问。通过正向代理，可以让本地访问一些远程的 localhost 服务。</p>
<p><em>Tips：除此之外，如果服务只有某一个网段的机器可以访问。也可以连接该网段内任意一台机器，通过 ssh 正向代理实现本地访问。</em></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># A</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">1234</span>:localhost:80<span class="w"> </span>B
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>curl<span class="w"> </span>http://localhost:1234<span class="w">  </span><span class="c1"># 此时 A 访问本地的 1234，实际访问的是 B 的 80</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1"># 非标准端口完整写法</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">1234</span>:localhost:80<span class="w"> </span>-p<span class="w"> </span><span class="m">2222</span><span class="w"> </span>root@B
</span></code></pre></div>
<h4 id="jumpssh-跳板机">jump——ssh 跳板机<a class="headerlink" href="#jumpssh-跳板机" title="Permanent link">&para;</a></h4>
<p>jump 本质就是通过中间节点代理 target ssh 端口。</p>
<ul>
<li>连续 jump</li>
</ul>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>ssh<span class="w"> </span>-J<span class="w"> </span>A,B<span class="w"> </span>C<span class="w">  </span><span class="c1"># 通过 A -&gt; B 再连接 C，A,B 逗号分隔</span>
</span></code></pre></div>
<ul>
<li>正向代理 + jump</li>
</ul>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ssh<span class="w"> </span>-J<span class="w"> </span>A<span class="w"> </span>-L<span class="w"> </span><span class="m">1234</span>:localhost:80<span class="w"> </span>B
</span></code></pre></div>
<h3 id="反向代理_1">反向代理<a class="headerlink" href="#反向代理_1" title="Permanent link">&para;</a></h3>
<h4 id="内网服务器使用本地上网">内网服务器使用本地上网<a class="headerlink" href="#内网服务器使用本地上网" title="Permanent link">&para;</a></h4>
<p>实验室可能有一些内网机器，笔记本可以连接，而且笔记本自身可以访问外网。此时可以让服务器通过本地访问外网。（对于科学上网场景同样有用，让服务器通过本地机器科学上网）</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># local</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>ssh<span class="w"> </span>-R<span class="w"> </span><span class="m">11223</span><span class="w"> </span>server
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># server</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">all_proxy</span><span class="o">=</span>socks5h://127.0.0.1:11223
</span></code></pre></div>
<ul>
<li>缺点是 ssh 只支持 socks 代理，curl 可以使用，wget 无法使用</li>
<li>可以通过后面的 gost 实现本地监听 http 代理</li>
<li>或者像 cfw 这样的代理软件，自身就会在本地监听 http/socks 代理服务，此时通过 ssh -R 将远程转发到本地代理端口</li>
</ul>
<h4 id="借用-vps-公网-v4-暴露本地服务">借用 VPS 公网 v4 暴露本地服务<a class="headerlink" href="#借用-vps-公网-v4-暴露本地服务" title="Permanent link">&para;</a></h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">### openwrt 路由器上</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1"># 将 ecs 2203 端口转发到本地 ssh</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>ssh<span class="w"> </span>-fNR<span class="w"> </span>:2203:localhost:22<span class="w"> </span>root@ecs<span class="w"> </span>-p<span class="w"> </span><span class="m">22</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1">### 公网访问 openwrt</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>ssh<span class="w"> </span>root@ecs<span class="w"> </span>-p<span class="w"> </span><span class="m">2203</span>
</span></code></pre></div>
<p>还需要设置 ssh 选项 keepalive，避免连接关闭。</p>
<p>bonus: openwrt ssh（dropbear）连接服务器时免密配置
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>mkdir<span class="w"> </span>~/.ssh
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>ln<span class="w"> </span>-s<span class="w"> </span>/etc/dropbear/dropbear_ed25519_host_key<span class="w"> </span>~/.ssh/id_dropbear<span class="w"> </span><span class="c1"># dropbear 默认 -i ~/.ssh/id_dropbear</span>
</span></code></pre></div></p>
<h4 id="代理公司内网">代理公司内网<a class="headerlink" href="#代理公司内网" title="Permanent link">&para;</a></h4>
<p>在外需要访问公司内网使用，可以使用内网任意一台机器执行一条命令实现一个简易的代理服务器</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>ssh<span class="w"> </span>-R<span class="w"> </span><span class="m">11223</span><span class="w"> </span>ecs
</span></code></pre></div>
<p>之后在浏览器上安装 Proxy SwitchOmega 插件，配置 Socks5 代理。</p>
<p><img alt="image.png" src="https://imagebed.yfycloud.site/2026/02/51d8d485203250398b40d4f0f3b690b7.png" /></p>
<p>在需要的网页上使用代理</p>
<p><img alt="image.png" src="https://imagebed.yfycloud.site/2026/02/8a5af1130232ae091ef8ae376f5eba0c.png" /></p>
<h2 id="gost">gost<a class="headerlink" href="#gost" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/ginuerzh/gost">ginuerzh/gost: GO Simple Tunnel - a simple tunnel written in golang</a></p>
<p>优点</p>
<ul>
<li>语法真的异常简洁，轻松实现搭建 socks/http/ss 代理，支持代理链等</li>
<li>支持几乎所有平台： linux, windows, freebsd + x86, amd64, arm, mips</li>
<li>体积只有 4MB</li>
</ul>
<h3 id="基本命令">基本命令<a class="headerlink" href="#基本命令" title="Permanent link">&para;</a></h3>
<p><strong>作为 http/Socks 代理</strong></p>
<p><img alt="image.png" src="https://imagebed.yfycloud.site/2026/01/89205d48b4932382144ff24bb3ea9a5f.png" /></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># 作为标准HTTP/SOCKS5代理（一个端口复用）</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>gost<span class="w"> </span>-L<span class="o">=</span>:8080
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># 带密码的 http 代理</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>gost<span class="w"> </span>-L<span class="w"> </span>http://user:pass@:8080
</span></code></pre></div>
<p><strong>多级转发代理(代理链)</strong></p>
<p><img alt="image.png" src="https://imagebed.yfycloud.site/2026/01/4d07e8a7f2cb304139ed326f15c239a9.png" /></p>
<p>gost 按照 -F 设置的顺序通过代理链将请求最终转发给 a.b.c.d:NNNN 处理，每一个转发代理可以是任意HTTP/HTTPS/HTTP2/SOCKS4/SOCKS5/Shadowsocks 类型代理。</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>gost<span class="w"> </span>-L<span class="o">=</span>:8080<span class="w"> </span>-F<span class="o">=</span>quic://192.168.1.1:6121<span class="w"> </span>-F<span class="o">=</span>socks5+wss://192.168.1.2:1080<span class="w"> </span>-F<span class="o">=</span>http2://192.168.1.3:443<span class="w"> </span>...<span class="w"> </span>-F<span class="o">=</span>a.b.c.d:NNNN
</span></code></pre></div>
<p><strong>正向代理/本地端口转发</strong></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># 将本地TCP端口2222上的数据(通过代理链)转发到192.168.1.1:22上</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>gost<span class="w"> </span>-L<span class="o">=</span>tcp://:2222/192.168.1.1:22<span class="w"> </span><span class="o">[</span>-F<span class="o">=</span>...<span class="o">]</span>
</span></code></pre></div>
<p><strong>反向代理/远程端口转发</strong></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># 将172.24.10.1:2222上的数据(通过代理链)转发到192.168.1.1:22上</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>gost<span class="w"> </span>-L<span class="o">=</span>rtcp://:2222/192.168.1.1:22<span class="w"> </span><span class="o">[</span>-F<span class="o">=</span>...<span class="w"> </span>-F<span class="o">=</span>socks5://172.24.10.1:1080<span class="o">]</span>
</span></code></pre></div>
<h3 id="用例">用例<a class="headerlink" href="#用例" title="Permanent link">&para;</a></h3>
<h4 id="vps-代理本地-ssh">VPS 代理本地 ssh<a class="headerlink" href="#vps-代理本地-ssh" title="Permanent link">&para;</a></h4>
<ul>
<li>本例子没有在 vps 启动 gost，而是复用了 ssh 服务作为底层隧道</li>
<li>本例子只是为了说明 gost 语法，实际使用 ssh 的 -R 是最方便的
<div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># 无公网机器 B</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>gost<span class="w"> </span>-L<span class="w"> </span>rtcp://:2204/127.0.0.1:22<span class="w"> </span>-F<span class="w"> </span>forward+ssh://user@vps:port?ssh_key<span class="o">=</span>/path/to/id
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># 之后通过 vps 公网 ip 访问 B</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>ssh<span class="w"> </span>xx@vps<span class="w"> </span>-p<span class="w"> </span><span class="m">2204</span>
</span></code></pre></div></li>
</ul>
<ul>
<li>目前 github 下载的 v2.12 (202410）是 v2 版本（gost v3 许多关键字都变了：<a href="https://gost.run/en/tutorials/protocols/ssh/">SSH - GOST</a>）
    - gost的SSH支持两种模式
        - Forwarding Mode（<code>forward+ssh</code>）：作为转发通道，支持 tcp，用于本地/远程TCP端口转发使用。
        - Tunnel Mode（<code>ssh</code>）：作为通道传输其他协议，支持 tcp, udp
    - <code>ssh_key</code> 用于权限验证</li>
<li>上面使用 vps 本来就有的 ssh 服务，因此<strong>不需要在 vps 上运行 gost 命令</strong></li>
<li>gost 优缺点
    - 可能解决了 ssh 需要保活的问题
    - 同样需要设置 <code>GatewayPorts yes</code></li>
</ul>
<h4 id="内网服务器使用本地上网_1">内网服务器使用本地上网<a class="headerlink" href="#内网服务器使用本地上网_1" title="Permanent link">&para;</a></h4>
<p>解决 ssh 只能监听 socks 代理的问题</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># 在本地启动带密码的 HTTP 代理</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>./gost<span class="w"> </span>-L<span class="w"> </span>http://user:pass@:8080
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># 将 ECS 的 1080 端口转发到本地的 8080 端口 </span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>ssh<span class="w"> </span>-R<span class="w"> </span><span class="m">1080</span>:localhost:8080<span class="w"> </span>ecs_user@ecs_ip
</span></code></pre></div>
<p>此时可以在服务器上使用 http 代理了</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">all_proxy</span><span class="o">=</span>http://user:pass@:8080
</span></code></pre></div>
<p><strong>如果使用单纯使用 gost，不使用 ssh</strong></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># 启动隧道服务端，监听 8000 端口用于建立隧道连接</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>./gost<span class="w"> </span>-L<span class="w"> </span>relay://:8000
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c1"># 1. 启动本地 HTTP 代理，带上你的用户名(user)和密码(pass) </span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="c1"># 2. 通过 rtcp 将 ECS 的 1080 端口映射到本地的 8080 端口 </span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>./gost<span class="w"> </span>-L<span class="w"> </span>http://user:pass@:8080<span class="w"> </span>-L<span class="w"> </span>rtcp://:1080/:8080<span class="w"> </span>-F<span class="w"> </span>relay://ECS_IP:8000
</span></code></pre></div>
<p>Tips：<strong>加密隧道</strong>：为了防止流量被识别或拦截，可以将 relay 替换为 relay+tls 或 relay+mwss（带证书加密）</p>







  
  




  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../../../../%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/2025/10/27/%E9%9B%B6%E6%88%90%E6%9C%AC%E9%83%A8%E7%BD%B2%E5%A4%9A%E4%BA%BA%20Gemini%20Pro%20AI%20%E6%9C%8D%E5%8A%A1/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 零成本部署多人Gemini Pro AI 服务">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                零成本部署多人Gemini Pro AI 服务
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../../../%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/2026/01/25/%E5%8F%8C%E5%AE%BD%E5%B8%A6%E4%B8%8A%E4%BC%A0%E5%8F%A0%E5%8A%A0%EF%BC%8C%E5%AE%9E%E7%8E%B0%E5%BC%82%E5%9C%B0%204K%20%E4%B8%B2%E6%B5%81/" class="md-footer__link md-footer__link--next" aria-label="下一页: 双宽带上传叠加，实现异地 4K 串流">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                双宽带上传叠加，实现异地 4K 串流
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/TheRainstorm" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.footer", "content.code.copy", "toc.follow", "toc.integrate"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>