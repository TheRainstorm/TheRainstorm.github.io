
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录一些关于数学、计算机的知识，以及一些日常。">
      
      
      
        <link rel="canonical" href="https://yfy.cqu.ai/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/2022/02/13/2022-02-13-openwrt%E5%88%B7%E6%9C%BA/">
      
      
        <link rel="prev" href="../2022-02-13-openwrt%E7%BC%96%E8%AF%91/">
      
      
        <link rel="next" href="../../14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>openwrt 刷机 - Rain 的随笔</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openwrt-硬件选择" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="Rain 的随笔" class="md-header__button md-logo" aria-label="Rain 的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rain 的随笔
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              openwrt 刷机
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  博客

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../about/" class="md-tabs__link">
        
  
  
    
  
  关于

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tags/" class="md-tabs__link">
        
  
  
    
  
  标签

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../series/" class="md-tabs__link">
        
  
  
    
  
  系列

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../tools/" class="md-tabs__link">
        
  
  
    
  
  工具

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../archive/2024/" class="md-tabs__link">
          
  
  
  归档

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../category/%E4%B8%AA%E4%BA%BA/" class="md-tabs__link">
          
  
  
  分类

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Rain 的随笔" class="md-nav__button md-logo" aria-label="Rain 的随笔" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Rain 的随笔
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    博客
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    标签
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    系列
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    归档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2022
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2021/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2021
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2020
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../archive/2019/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2019
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    分类
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            分类
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E4%B8%AA%E4%BA%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%8D%9A%E5%AE%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    博客
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%8D%9A%E5%AE%A2--%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    博客 &amp; 网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    学习笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    折腾记录
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    课程笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    软件工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../category/%E9%98%85%E8%AF%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    阅读
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2022-02-13 01:18:16+00:00" class="md-ellipsis">2022年2月13日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../../../../category/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/">折腾记录</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 31 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openwrt-硬件选择" class="md-nav__link">
    <span class="md-ellipsis">
      Openwrt 硬件选择
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Openwrt 硬件选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#小米路由器型号总结" class="md-nav__link">
    <span class="md-ellipsis">
      小米路由器型号总结
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米路由器型号总结">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-分类" class="md-nav__link">
    <span class="md-ellipsis">
      CPU 分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#小米系列产品" class="md-nav__link">
    <span class="md-ellipsis">
      小米系列产品
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2023-wifi6产品" class="md-nav__link">
    <span class="md-ellipsis">
      2023 wifi6产品
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2023 wifi6产品">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu对比" class="md-nav__link">
    <span class="md-ellipsis">
      CPU对比
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2024-新需求" class="md-nav__link">
    <span class="md-ellipsis">
      2024 新需求
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2024 新需求">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#之后的网络规划" class="md-nav__link">
    <span class="md-ellipsis">
      之后的网络规划
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#刷机过程总结" class="md-nav__link">
    <span class="md-ellipsis">
      刷机过程总结
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#小米路由器救砖" class="md-nav__link">
    <span class="md-ellipsis">
      小米路由器救砖
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米路由器救砖">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#有官方-bootloader-的情况" class="md-nav__link">
    <span class="md-ellipsis">
      有官方 bootloader 的情况
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#刷了-breed" class="md-nav__link">
    <span class="md-ellipsis">
      刷了 breed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#常用操作" class="md-nav__link">
    <span class="md-ellipsis">
      常用操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="常用操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#刷之前备份-mtd-分区" class="md-nav__link">
    <span class="md-ellipsis">
      刷之前备份 mtd 分区
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshot-的说明" class="md-nav__link">
    <span class="md-ellipsis">
      snapshot 的说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#命令行安装-sysupgradebin" class="md-nav__link">
    <span class="md-ellipsis">
      命令行安装 sysupgrade.bin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#备份恢复-cli" class="md-nav__link">
    <span class="md-ellipsis">
      备份恢复 CLI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#性能测试" class="md-nav__link">
    <span class="md-ellipsis">
      性能测试
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iperf3" class="md-nav__link">
    <span class="md-ellipsis">
      iperf3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#具体型号刷机过程" class="md-nav__link">
    <span class="md-ellipsis">
      具体型号刷机过程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="具体型号刷机过程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redmi-ac2100-刷-openwrt" class="md-nav__link">
    <span class="md-ellipsis">
      Redmi AC2100 刷 Openwrt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Redmi AC2100 刷 Openwrt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-确认-stock-系统版本" class="md-nav__link">
    <span class="md-ellipsis">
      1. 确认 stock 系统版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-获得-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      2. 获得 ssh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-下载-openwrt-镜像" class="md-nav__link">
    <span class="md-ellipsis">
      3. 下载 openwrt 镜像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-备份" class="md-nav__link">
    <span class="md-ellipsis">
      4. 备份
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-设置环境变量" class="md-nav__link">
    <span class="md-ellipsis">
      5. 设置环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-刷机" class="md-nav__link">
    <span class="md-ellipsis">
      6. 刷机
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mi-4a-千兆版" class="md-nav__link">
    <span class="md-ellipsis">
      MI 4A 千兆版
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MI 4A 千兆版">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#说明" class="md-nav__link">
    <span class="md-ellipsis">
      说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#步骤" class="md-nav__link">
    <span class="md-ellipsis">
      步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#参考" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eeprom-下载" class="md-nav__link">
    <span class="md-ellipsis">
      EEPROM 下载
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eeprom-修改" class="md-nav__link">
    <span class="md-ellipsis">
      EEPROM 修改
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#空间不足可以安装的软件" class="md-nav__link">
    <span class="md-ellipsis">
      空间不足（可以安装的软件）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mi-r3g" class="md-nav__link">
    <span class="md-ellipsis">
      MI R3G
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MI R3G">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#准备" class="md-nav__link">
    <span class="md-ellipsis">
      准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#开启-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      开启 ssh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#备份" class="md-nav__link">
    <span class="md-ellipsis">
      备份
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#刷-openwrt" class="md-nav__link">
    <span class="md-ellipsis">
      刷 openwrt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ax6s" class="md-nav__link">
    <span class="md-ellipsis">
      AX6S
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AX6S">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#步骤_1" class="md-nav__link">
    <span class="md-ellipsis">
      步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#坑sysupgrade-变砖" class="md-nav__link">
    <span class="md-ellipsis">
      坑：sysupgrade 变砖
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#竞斗云-20pw" class="md-nav__link">
    <span class="md-ellipsis">
      竞斗云 2.0（P&amp;W)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="竞斗云 2.0（P&amp;W)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#资料" class="md-nav__link">
    <span class="md-ellipsis">
      资料
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#教程" class="md-nav__link">
    <span class="md-ellipsis">
      教程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#遇到问题" class="md-nav__link">
    <span class="md-ellipsis">
      遇到问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#360-t7" class="md-nav__link">
    <span class="md-ellipsis">
      360 T7
    </span>
  </a>
  
    <nav class="md-nav" aria-label="360 T7">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#基本参数" class="md-nav__link">
    <span class="md-ellipsis">
      基本参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#准备_1" class="md-nav__link">
    <span class="md-ellipsis">
      准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-拆机和-ttl-模块连接" class="md-nav__link">
    <span class="md-ellipsis">
      1. 拆机和 TTL 模块连接
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ttl-进入-failsafe-模式开启-telnet" class="md-nav__link">
    <span class="md-ellipsis">
      2. TTL 进入 failsafe 模式开启 telnet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-刷改版-uboot-并刷固件" class="md-nav__link">
    <span class="md-ellipsis">
      3. 刷改版 uboot 并刷固件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#性能问题" class="md-nav__link">
    <span class="md-ellipsis">
      性能问题
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wifi-跑不到千兆" class="md-nav__link">
    <span class="md-ellipsis">
      wifi 跑不到千兆
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#固件选择" class="md-nav__link">
    <span class="md-ellipsis">
      固件选择
    </span>
  </a>
  
    <nav class="md-nav" aria-label="固件选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mtwifi-闭源驱动" class="md-nav__link">
    <span class="md-ellipsis">
      mtwifi 闭源驱动
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#不确定" class="md-nav__link">
    <span class="md-ellipsis">
      不确定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#小米-wr30u" class="md-nav__link">
    <span class="md-ellipsis">
      小米 WR30U
    </span>
  </a>
  
    <nav class="md-nav" aria-label="小米 WR30U">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#刷机" class="md-nav__link">
    <span class="md-ellipsis">
      刷机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#固件" class="md-nav__link">
    <span class="md-ellipsis">
      固件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#官方教程" class="md-nav__link">
    <span class="md-ellipsis">
      官方教程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#其它-7981" class="md-nav__link">
    <span class="md-ellipsis">
      其它 7981
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jcg-q30-pro" class="md-nav__link">
    <span class="md-ellipsis">
      JCG Q30 PRO
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JCG Q30 PRO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#遇到问题_1" class="md-nav__link">
    <span class="md-ellipsis">
      遇到问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tl-xdr6088" class="md-nav__link">
    <span class="md-ellipsis">
      TL-XDR6088
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TL-XDR6088">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug-版本刷机" class="md-nav__link">
    <span class="md-ellipsis">
      debug 版本刷机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#接口" class="md-nav__link">
    <span class="md-ellipsis">
      接口
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cudy-tr3000-v1" class="md-nav__link">
    <span class="md-ellipsis">
      cudy tr3000 v1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cudy tr3000 v1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#刷-openwrt_1" class="md-nav__link">
    <span class="md-ellipsis">
      刷 openwrt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#从-openwrt-恢复为官方" class="md-nav__link">
    <span class="md-ellipsis">
      从 openwrt 恢复为官方
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ft" class="md-nav__link">
    <span class="md-ellipsis">
      FT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#其它" class="md-nav__link">
    <span class="md-ellipsis">
      其它
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#硬件性能测试-wg-带宽" class="md-nav__link">
    <span class="md-ellipsis">
      硬件性能测试 (wg 带宽)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="硬件性能测试 (wg 带宽)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#king3399" class="md-nav__link">
    <span class="md-ellipsis">
      king3399
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p2w" class="md-nav__link">
    <span class="md-ellipsis">
      p2w
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ax6s_1" class="md-nav__link">
    <span class="md-ellipsis">
      ax6s
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
        <a href="../../../../../tags/#tag:openwrt" class="md-tag">openwrt</a>
      
    
      
      
      
        <a href="../../../../../tags/#tag:如何实现网络自由" class="md-tag">如何实现网络自由</a>
      
    
  </nav>



  <h1>openwrt 刷机</h1>

<p>介绍了从硬件选择到刷机整个过程</p>
<!-- more -->

<h2 id="openwrt-硬件选择">Openwrt 硬件选择<a class="headerlink" href="#openwrt-硬件选择" title="Permanent link">&para;</a></h2>
<p>如何选择一个可以刷 openwrt 的路由器？</p>
<ul>
<li><a href="https://post.smzdm.com/p/awznd6qg/">老房子 WiFi 布网攻略 篇三十八：WiFi 6 梅林或 openwrt 固件路由器入手指南_路由器_什么值得买 (smzdm.com)</a></li>
<li><a href="https://post.smzdm.com/p/apzkqlrx/">老房子 WiFi 布网攻略 篇二十四：不漏油的路由器不是好矿机，矿渣路由器盘点_路由器_什么值得买 (smzdm.com)</a></li>
<li>极路由、新路由：<a href="https://www.right.com.cn/forum/thread-8097191-1-1.html">机皇！几种高性价比矿渣路由器比较 - 新手入门及其它 (硬件)-恩山无线论坛 (right.com.cn)</a></li>
</ul>
<h3 id="小米路由器型号总结">小米路由器型号总结<a class="headerlink" href="#小米路由器型号总结" title="Permanent link">&para;</a></h3>
<h4 id="cpu-分类">CPU 分类<a class="headerlink" href="#cpu-分类" title="Permanent link">&para;</a></h4>
<ul>
<li>mt7621 型号<ul>
<li>R3G：咸鱼 50 元左右，有 USB3.0 接口，128MB 的 flash。</li>
<li>4A 千兆版：咸鱼 70 元左右，外观简约漂亮，16MB NOR flash 有点小。</li>
<li>C660x：咸鱼 100 多，支持 wifi6</li>
</ul>
</li>
<li>高通型号<ul>
<li><strong>目前 (22.03) 只有 AX6S 是受 openwrt 官方支持的</strong>，AX6, AX3600 有第三方支持。AX5 等其余未支持<ul>
<li>不能刷好像是 linux kernel 还不支持高通的 IPQ SoC。</li>
<li>B 站看到说 AX5 刷 openwrt 需要硬改内存为 1G，好像说高通的 wifi 驱动非常耗内存</li>
</ul>
</li>
<li>AX6S：220 左右</li>
<li>AX6:250-300 左右</li>
</ul>
</li>
</ul>
<h4 id="小米系列产品">小米系列产品<a class="headerlink" href="#小米系列产品" title="Permanent link">&para;</a></h4>
<ul>
<li>红米 AX5，小米 AX1800 换皮<ul>
<li>IPQ6000, 4 核 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#50;&#71;&#104;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#50;&#71;&#104;&#122;</a>：[<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_ax1800">OpenWrt Wiki] Xiaomi AX1800 (AX5/RA67)</a></li>
</ul>
</li>
</ul>
<ul>
<li><strong>红米AX6</strong>，小米AX3600换皮<ul>
<li>AX6, <strong>IPQ8071A</strong>@1.4GHz, 512(ram) + 128：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_redmi_ax6_ax3000">[OpenWrt Wiki] Xiaomi Redmi AX6 Wi-Fi 6 Mesh Router</a></li>
<li>AX3600, IPQ8071A, 512 + 256：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_ax3600">[OpenWrt Wiki] Xiaomi AX3600</a></li>
<li>对比：<a href="https://www.acwifi.net/11176.html">红米AX6拆机，旧款WIFI6无线路由器-路由器交流 (acwifi.net)</a></li>
</ul>
</li>
<li>AX3000<ul>
<li><strong>红米AX3000（比较常见）</strong>，IPQ5000：双核<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;</a>, 256(ram) + 128：<a href="https://www.mi.com/shop/buy/detail?product_id=14538">Redmi路由器AX3000立即购买-小米商城</a></li>
<li>小米AX3000：IPQ5000：双核<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;</a>, 256(ram) + 128：<a href="https://www.mi.com/shop/buy/detail?product_id=14790">小米路由器AX3000立即购买-小米商城 (mi.com)</a></li>
<li>红米AX3000模具和AX6S一样，为白色。小米AX3000为黑色四棱柱。</li>
</ul>
</li>
<li>AX5400<ul>
<li>红米AX5400，IPQ5018：双核<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#72;&#122;</a>，512(ram) + 128：<a href="https://www.acwifi.net/19451.html">红米AX5400千兆版拆机，看看与电竞版有什么差别-路由器交流 (acwifi.net)</a></li>
</ul>
</li>
<li>AX6000<ul>
<li>小米AX6000<ul>
<li>IPQ5018, 2核<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#104;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#48;&#71;&#104;&#122;</a>, 512(ram) + 128</li>
<li>使用的SoC IPQ5018为高通沉浸式家庭联网平台，不如高通专业联网平台的IPQ8071A（AX3600上的）</li>
</ul>
</li>
<li><strong>红米AX6000（很强）</strong><ul>
<li><strong>MT7986A</strong>, 4核<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#50;&#46;&#48;&#71;&#104;&#122;">&#65;&#53;&#51;&#64;&#50;&#46;&#48;&#71;&#104;&#122;</a>, 512(ram) + 128：[<a href="https://openwrt.org/toh/xiaomi/redmi_ax6000">OpenWrt Wiki] Xiaomi Redmi AX6000</a></li>
<li><a href="https://www.acwifi.net/19676.html">红米AX6000拆机，最便宜的四核2.0GHz-路由器交流 (acwifi.net)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img alt="image-20221029213022447" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20221029213022447.png" /></p>
<p>参考</p>
<ul>
<li><a href="https://www.zhihu.com/question/474579126">(33 封私信 / 71 条消息) 路由器红米ax3000和红米ax6选择哪个? - 知乎 (zhihu.com)</a></li>
<li>小米openwrt页面：<a href="https://openwrt.org/toh/hwdata/xiaomi/start">[OpenWrt Wiki] Xiaomi</a></li>
<li>常见MediaTek SoC：<a href="https://wikidevi.wi-cat.ru/MediaTek">MediaTek - WikiDevi.Wi-Cat.RU</a></li>
</ul>
<h3 id="2023-wifi6产品">2023 wifi6产品<a class="headerlink" href="#2023-wifi6产品" title="Permanent link">&para;</a></h3>
<p>现在需求wifi6，且信号覆盖广</p>
<ul>
<li>小米wr30u：运营商定制版</li>
<li>360 T7：和上者硬件一摸一样。12v 1A</li>
</ul>
<p>wr30u: wifi6: <a href="https://www.acwifi.net/23700.html">小米WR30U无线路由器拆机 AX3000联通定制版-路由器交流 (acwifi.net)</a>
<a href="https://zhuanlan.zhihu.com/p/640643641">2023年支持刷机的路由器大全（建议收藏） - 知乎 (zhihu.com)</a></p>
<ul>
<li>AX1800：cr660x</li>
<li>AX3000：cr880x：135</li>
</ul>
<p><a href="https://www.v2ex.com/t/948845">618 想买台路由器求推荐 - V2EX</a>
150的T7 512改：<a href="https://www.saraba1st.com/2b/thread-2141173-1-1.html">WR30U路由到了随手测测 - ＰＣ数码 - Stage1st - stage1/s1 游戏动漫论坛 (saraba1st.com)</a></p>
<h4 id="cpu对比">CPU对比<a class="headerlink" href="#cpu对比" title="Permanent link">&para;</a></h4>
<p>参考：</p>
<ul>
<li>[<a href="https://www.right.com.cn/forum/thread-216888-1-1.html">转贴] 无线路由器CPU浅析 MT7621A、 BCM47189 到底谁强？-新手入门及其它(硬件)-恩山无线论坛 (right.com.cn)</a></li>
</ul>
<ul>
<li>树莓派系列处理器：<a href="https://www.raspberrypi.com/documentation/computers/processors.html">Raspberry Pi Documentation - Processors</a><ul>
<li>Raspberry Pi 2 Model B： BCM2836(quad-core Cortex-A7 )</li>
<li>Raspberry Pi 3 Model B：BCM2837( quad-core Cortex-A53@1.2)<ul>
<li>50% faster than the Raspberry Pi 2.</li>
</ul>
</li>
<li>Raspberry Pi 3 Models A+, B+: BCM2837B0(quad-core Cortex-A53@1.4)<ul>
<li>17% faster than the original Raspberry Pi 3</li>
</ul>
</li>
<li>Raspberry Pi 4 Model B: BCM2837(quad-core Cortex-A72@1.5 GHz)<ul>
<li>50% faster than the Raspberry Pi 3B+</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>ARM核对比：<a href="https://en.wikipedia.org/wiki/List_of_ARM_processors">List of ARM processors - Wikipedia</a><ul>
<li>Cortex-A7: 1.9 DMIPS/MHz per core</li>
<li>A53: 2.3 DMIPS/MHz</li>
<li>A72: 6.3-7.3 DMIPS/MHz</li>
</ul>
</li>
<li>MIPS核：<a href="https://www.mips.com/products/classic/">MIPS Classic Processor Cores - Imagination Technologies</a><ul>
<li>1004K: 1.6 DMIPS/MHz</li>
</ul>
</li>
<li>74k: 1.93 DMIPS/MHz：CSAC路由器：71</li>
</ul>
<ul>
<li><a href="https://github.com/sawaYch/newifi3-d2-firmware/blob/master/README.md">newifi3-d2-firmware/README.md at master · sawaYch/newifi3-d2-firmware (github.com)</a></li>
</ul>
<h3 id="2024-新需求">2024 新需求<a class="headerlink" href="#2024-新需求" title="Permanent link">&para;</a></h3>
<p>家里搭建的软路由 + 多 AP 在一次断电后上不了网。无法远程访问无法修复。由于设置了桥接 + 路由器拨号。所以也无法指导父母换回原来的腾达路由器。</p>
<p>平时和父母通话时，父亲老师抱怨说网络不好。应该是他总是连接到位置不对的 AP，让他断开 wifi 重新连接一下往往能解决问题。</p>
<p>于是这次决定换一个无线信号好的路由器，采用单个路由器的方案。然后让宽带师傅帮忙安装一下。</p>
<div class="admonition note">
<p class="admonition-title">据说维修很曲折</p>
<p>由于不是移动的路由器，是自己的路由器的问题，收了 30 元的维修费。中午 1 点 打 10086，下午 4 点就来维修了这点不错。据说搞了很久，可能是我设置了桥接的原因，宽带师傅搞了半天没搞定，最后把光猫换了个新的（好像说挺好的，适用于千兆宽带）我也让他帮忙把一楼原本的 AP 接上了。好在 AP 不需要额外设置，插上网线就能用。猜测现在网络应该是光猫拨号，主路由器 dhcp，也就是有两次 NAT</p>
</div>
<h4 id="之后的网络规划">之后的网络规划<a class="headerlink" href="#之后的网络规划" title="Permanent link">&para;</a></h4>
<p>经过这次事件后，意识到网络还是需要简单稳定。软路由做主路由这种方案不适合家里，因为出了问题，根本无法远程指导父母修复。甚至宽带师傅也不知道怎么修复。而且只要问题出在光猫上，运营商就可以免费给我修。因此考虑将软路由作为旁路由。方案如下</p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20240915172922.png" /></p>
<p><img alt="image.png" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20240915172942.png" /></p>
<p>需求
- 以后能够刷 openwrt
- <strong>无线信号好</strong>，能够覆盖 100 平农村自建房。光纤入户在二楼，因此路由器需要能够覆盖 1 楼 和 2 楼。
- 有 2.5 G 接口
  - 因为想到既然都升级了，需要把我软路由 2.5 G 口利用起来
  - 单 2.5 G 和双 2.5 G 选择
    - 突然意识到，在我的软路由有 4 口 2.5 G 的情况下。单 2.5 G 够用了，并且还便宜很多。</p>
<p>xdr 4288<a href="https://www.acwifi.net/22095.html">TP-LINK轻舟XDR4288拆机，双频不对称空间流-路由器交流 (acwifi.net)</a></p>
<blockquote>
<p>两三台组网用的话，这一台做主路由，也不需要多强的无线。如果要一台全能形的，就在6088和6086之间选择吧。都是低温低热的，相对高通IPQ5000系列方案的机型！京东价格669元，按需选择吧。</p>
</blockquote>
<p>xdr 6088：<a href="https://www.acwifi.net/20864.html">轻舟XDR6088拆机，双2.5G网口的无线路由器-路由器交流 (acwifi.net)</a></p>
<p>发现直接看这里，就有推荐的性价比路由器：<a href="https://www.acwifi.net/0-wifi">特价路由汇总-路由器交流 (acwifi.net)</a></p>
<ul>
<li>都说 xdr 5480 信号好。咸鱼价格 265 （2024/09/11）。但是不能刷 op， 有一个 SPF 2.5G 口（SPF 模块大概 50-100元）。适合做 AP。</li>
<li>xdr6088。咸鱼价格 419（2024/09/11）。某个版本可以免拆刷 op。双 2.5G<ul>
<li>7986A, 512+128</li>
</ul>
</li>
</ul>
<p><a href="https://www.chiphell.com/forum.php?mod=viewthread&amp;tid=2537251&amp;extra=&amp;highlight=XDR&amp;page=1">无线信号达到XDR5480/6088同级或以上的可魔改路由 - 电脑讨论(新) - Chiphell - 分享与交流用户体验</a></p>
<p>不过我感觉我需要一个不错的路由做主路由，同时软路由作为子路由。这样子可以避免软路由挂掉，整个网络挂掉。组网感觉在软路由上组。</p>
<h2 id="刷机过程总结">刷机过程总结<a class="headerlink" href="#刷机过程总结" title="Permanent link">&para;</a></h2>
<p>以红米AC2100可能的刷机为例，涵盖了openwrt的各种情况：刷breed，恢复，临时镜像</p>
<ul>
<li><strong>建议直接使用官方openwrt镜像 + 官方安装方式。几次使用breed都遇到了问题，而小米官方恢复工具也挺好用的。</strong></li>
</ul>
<ul>
<li>
<p>第一次自己刷机红米AC2100[[记录红米AC2100折腾]]，一张精华图</p>
<p><img alt="image-20210622145337241" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20210622145337241.png" /></p>
</li>
</ul>
<ul>
<li>路由器刷出问题，修复经验。知道了备份的重要性[[记录记一次路由器刷出问题修复过程]]</li>
</ul>
<h2 id="小米路由器救砖">小米路由器救砖<a class="headerlink" href="#小米路由器救砖" title="Permanent link">&para;</a></h2>
<h3 id="有官方-bootloader-的情况">有官方 bootloader 的情况<a class="headerlink" href="#有官方-bootloader-的情况" title="Permanent link">&para;</a></h3>
<p><strong>说明：</strong></p>
<p>官方的引导程序使用的是 uboot，位于 flash 的 Bootloader 分区，而官方固件则位于 OS1 分区（红米 AC2100）。正常刷 openwrt 的过程中不会修改 bootloader。只要还保留着官方 bootloader，就可以通过官方修复工具恢复。</p>
<p><strong>步骤：</strong></p>
<ol>
<li>下载<code>小米路由器修复工具</code>和官方镜像：<a href="https://www.xiaomi.cn/post/19184644">【下载汇总】客户端/ROM 下载 - 小米社区 (xiaomi.cn)</a></li>
<li><strong>路由器通电</strong>，PC 通过网线连接到路由器 LAN 口</li>
<li>打开<code>MIWIFIRepairTool.x86.exe</code></li>
<li>选择镜像</li>
<li><strong>选择网卡</strong>（可以在网络中心中将其它网卡禁用）</li>
<li>断开路由器电源，按住 rst 键（也有可能需要用针戳），然后接上电源，等待黄灯闪烁（两个灯，一个是有电源标志，一个有互联网标志，这里为电源灯那个）</li>
<li>软件自动上传镜像</li>
<li>保持耐心等待路由器黄灯变蓝（中间过程保持黄灯），<strong>亲测需要 4 分钟</strong></li>
<li>断电后重新接上电源，路由器重启</li>
</ol>
<h3 id="刷了-breed">刷了 breed<a class="headerlink" href="#刷了-breed" title="Permanent link">&para;</a></h3>
<p><strong>说明：</strong></p>
<p>breed 自身便是一个 bootloader，刷完 breed 后会覆盖原本的 bootloader。如果想复原，可通过 breed 的功能，重新刷回官方 bootloader。<strong>强烈建议刷 breed 前，先备份原本的 bootloader 以及整个 flash</strong>。如果没备份，这里是恩山上收集的<strong>小米官方 bootloader 下载</strong>：<a href="https://www.right.com.cn/forum/thread-4102208-1-1.html">论坛收集的几个小米路由器官方 bootloader - 恩山无线论坛</a></p>
<p><strong>步骤：</strong></p>
<ol>
<li>通过 breed 刷回官方 bootloader</li>
<li>通过官方修复工具修复</li>
</ol>
<h2 id="常用操作">常用操作<a class="headerlink" href="#常用操作" title="Permanent link">&para;</a></h2>
<h3 id="刷之前备份-mtd-分区">刷之前备份 mtd 分区<a class="headerlink" href="#刷之前备份-mtd-分区" title="Permanent link">&para;</a></h3>
<p>路由器 flash 有若干分区，其中有一个分区存储路由器 MAC 地址、无线校准参数等。若损坏可能导致无线信号弱等问题。因此刷之前最好备份。
查看 mtd 分区</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>root@XiaoQiang:~#<span class="w"> </span>cat<span class="w"> </span>/proc/mtd
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>dev:<span class="w">    </span>size<span class="w">   </span>erasesize<span class="w">  </span>name
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>mtd0:<span class="w"> </span>07f80000<span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;ALL&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>mtd1:<span class="w"> </span><span class="m">00080000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Bootloader&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>mtd2:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Config&quot;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>mtd3:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Bdata&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>mtd4:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;Factory&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>mtd5:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;crash&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>mtd6:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;crash_syslog&quot;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>mtd7:<span class="w"> </span><span class="m">00040000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;reserved0&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>mtd8:<span class="w"> </span><span class="m">00400000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;kernel0&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>mtd9:<span class="w"> </span><span class="m">00400000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;kernel1&quot;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>mtd10:<span class="w"> </span><span class="m">02000000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;rootfs0&quot;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>mtd11:<span class="w"> </span><span class="m">02000000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;rootfs1&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>mtd12:<span class="w"> </span><span class="m">03580000</span><span class="w"> </span><span class="m">00020000</span><span class="w"> </span><span class="s2">&quot;overlay&quot;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>mtd13:<span class="w"> </span>012a6000<span class="w"> </span>0001f000<span class="w"> </span><span class="s2">&quot;ubi_rootfs&quot;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>mtd14:<span class="w"> </span>030ec000<span class="w"> </span>0001f000<span class="w"> </span><span class="s2">&quot;data&quot;</span>
</span></code></pre></div>
<p>备份 factory 分区（小米路由器一般是 factory 存储了上述那些数据）</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cat<span class="w"> </span>/dev/mtd4<span class="w"> </span>&gt;<span class="w"> </span>/tmp/factory.bin
</span></code></pre></div>
<p>之后通过 scp 复制到本地</p>
<h3 id="snapshot-的说明">snapshot 的说明<a class="headerlink" href="#snapshot-的说明" title="Permanent link">&para;</a></h3>
<p>snapshot 是开发版分支</p>
<ul>
<li>默认没有安装 luci（没有网页界面）</li>
<li>上游每天都会编译产生新的 snapshot。对于 kernel mod 相关软件，不是同一次编译则无法安装。</li>
<li>[<a href="https://openwrt.org/docs/guide-quick-start/developmentinstallation">OpenWrt Wiki] Installing OpenWrt development snapshots</a></li>
</ul>
<h3 id="命令行安装-sysupgradebin">命令行安装 sysupgrade.bin<a class="headerlink" href="#命令行安装-sysupgradebin" title="Permanent link">&para;</a></h3>
<ul>
<li>[<a href="https://openwrt.org/docs/guide-user/installation/sysupgrade.cli">OpenWrt Wiki] Upgrading OpenWrt firmware using CLI</a></li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sysupgrade -v /tmp/firmware_image.bin
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>#If sysupgrade is not available.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a># Flash firmware
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>mtd -r write /tmp/firmware_image.bin firmware
</span></code></pre></div>
<h3 id="备份恢复-cli">备份恢复 CLI<a class="headerlink" href="#备份恢复-cli" title="Permanent link">&para;</a></h3>
<ul>
<li>官方：[<a href="https://openwrt.org/docs/guide-user/troubleshooting/backup_restore">OpenWrt Wiki] Backup and restore</a></li>
</ul>
<p>自己实现了一个自动配置 openwrt 脚本</p>
<ul>
<li><a href="https://github.com/TheRainstorm/my-openwrt-config">TheRainstorm/my-openwrt-config (github.com)</a></li>
</ul>
<h3 id="性能测试">性能测试<a class="headerlink" href="#性能测试" title="Permanent link">&para;</a></h3>
<h4 id="iperf3">iperf3<a class="headerlink" href="#iperf3" title="Permanent link">&para;</a></h4>
<p>ax6s &amp; mi4a</p>
<table>
<thead>
<tr>
<th>测试目的</th>
<th>连接</th>
<th>src</th>
<th>dst</th>
<th>speed(Mb/s)</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>ax6s LAN 性能</td>
<td>千兆 USB 网卡</td>
<td>tianyi310</td>
<td>ax6s</td>
<td><strong>941</strong></td>
<td></td>
</tr>
<tr>
<td>ax6s 无线性能</td>
<td>wifi6 5Ghz@1201</td>
<td>s3pro</td>
<td>ax6s</td>
<td><strong>626</strong></td>
<td></td>
</tr>
<tr>
<td>mi4a LAN 性能</td>
<td>2.5G 网卡</td>
<td>ryzen</td>
<td>mi4a</td>
<td><strong><em>470</em></strong></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>隧道性能</td>
<td></td>
<td>tianyi310</td>
<td>ryzen</td>
<td>118</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>隧道性能</td>
<td></td>
<td>mi4a</td>
<td>ax6s</td>
<td>136</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ax6s</td>
<td>mi4a</td>
<td>149</td>
<td></td>
</tr>
<tr>
<td>mi4a 交换性能</td>
<td>ryzen - mi4a - p2w</td>
<td>ryzen</td>
<td>p2w</td>
<td><strong>943</strong></td>
<td>结果居然比 ryzen - mi4a 还要快！</td>
</tr>
</tbody>
</table>
<p>将 r4a 替换掉后
| 测试目的 | src       | dst       | speed(Mb/s) | 备注 |
| -------- | --------- | --------- | ----------- | ---- |
| p2w      | ryzen     | p2w       | <strong>936</strong>     |      |
|          | p2w       | ryzen     | <strong><em>577</em></strong>   |      |
| 隧道性能 | p2w       | ax6s      | 150         |      |
|          | ax6s      | p2w       | 250         |      |
| 隧道性能 | ryzen     | tianyi310 | <strong>295</strong>     |      |
|          | tianyi310 | ryzen     | <strong>173</strong>     |      |
|          | s3pro     | ryzen     | 256         |      |
| 780/886  | s3pro     | p2w       | <strong>370</strong>     |      |
|          | ryzen     | s3pro     | 274         |      |</p>
<h2 id="具体型号刷机过程">具体型号刷机过程<a class="headerlink" href="#具体型号刷机过程" title="Permanent link">&para;</a></h2>
<h3 id="redmi-ac2100-刷-openwrt">Redmi AC2100 刷 Openwrt<a class="headerlink" href="#redmi-ac2100-刷-openwrt" title="Permanent link">&para;</a></h3>
<p><a href="https://openwrt.org/toh/xiaomi/xiaomi_redmi_router_ac2100">[OpenWrt Wiki] Xiaomi Redmi Router AC2100</a></p>
<h4 id="1-确认-stock-系统版本">1. 确认 stock 系统版本<a class="headerlink" href="#1-确认-stock-系统版本" title="Permanent link">&para;</a></h4>
<p>确认系统版本是否为 2.0.23，如果不是，则在系统内手动升级到该版本 <a href="http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin">http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin</a></p>
<h4 id="2-获得-ssh">2. 获得 ssh<a class="headerlink" href="#2-获得-ssh" title="Permanent link">&para;</a></h4>
<p>使用 web 漏洞，获得 ssh</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Work for RedMi 2100 firmware 2.0.23</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1">// http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_all_fb720_2.0.23.bin</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getSTOK</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/;stok=(.*?)\//</span><span class="p">);</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="p">}</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="kd">function</span><span class="w"> </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="nx">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">command</span><span class="p">);</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`/cgi-bin/luci/;stok=</span><span class="si">${</span><span class="nx">stok</span><span class="si">}</span><span class="sb">/api/misystem/set_config_iotdev?bssid=SteelyWing&amp;user_id=SteelyWing&amp;ssid=-h%0A</span><span class="si">${</span><span class="nx">command</span><span class="si">}</span><span class="sb">%0A`</span><span class="p">;</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Request</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">path</span><span class="p">));</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="p">}</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="kd">function</span><span class="w"> </span><span class="nx">enableSSH</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">    </span><span class="nx">stok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getSTOK</span><span class="p">();</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">stok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;stok not found in URL&#39;</span><span class="p">);</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`stok = &quot;</span><span class="si">${</span><span class="nx">stok</span><span class="si">}</span><span class="sb">&quot;`</span><span class="p">);</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">    </span><span class="nx">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;Input new SSH password&#39;</span><span class="p">);</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;You must input password&#39;</span><span class="p">);</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">    </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="sb">`</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="sb">nvram set ssh_en=1</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="sb">nvram commit</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="sb">sed -i &#39;s/channel=.*/channel=\\&quot;debug\\&quot;/g&#39; /etc/init.d/dropbear</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="sb">/etc/init.d/dropbear start</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="sb">`</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">));</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;New SSH password: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">password</span><span class="p">);</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">    </span><span class="nx">execute</span><span class="p">(</span><span class="nx">stok</span><span class="p">,</span><span class="w"> </span><span class="sb">`echo -e &quot;</span><span class="si">${</span><span class="nx">password</span><span class="si">}</span><span class="sb">\\n</span><span class="si">${</span><span class="nx">password</span><span class="si">}</span><span class="sb">&quot; | passwd root`</span><span class="p">)</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">));</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="p">}</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="nx">enableSSH</span><span class="p">();</span>
</span></code></pre></div>
<h4 id="3-下载-openwrt-镜像">3. 下载 openwrt 镜像<a class="headerlink" href="#3-下载-openwrt-镜像" title="Permanent link">&para;</a></h4>
<p>从官方下载最新镜像，注意有四个文件</p>
<ul>
<li>kernel: 具有最少文件系统的 Linux 内核。对于首次安装或恢复很有用。</li>
<li>kernel1: Linux 内核作为单独的映像</li>
<li>rootfs0: 根文件系统作为单独的映像。</li>
<li>Sysupgrade: 使用 Sysupgrade 映像更新已经运行 OpenWrt 的路由器。该映像可以与 LuCI Web 界面或终端一起使用。</li>
</ul>
<p>需要下载 kernel1 和 rootfs0</p>
<ul>
<li><a href="https://downloads.openwrt.org/">OpenWrt Downloads</a></li>
<li><a href="https://firmware-selector.openwrt.org/">OpenWrt Firmware Selector</a></li>
</ul>
<h4 id="4-备份">4. 备份<a class="headerlink" href="#4-备份" title="Permanent link">&para;</a></h4>
<p>通过 dmesg，知道一共有 14 个 mtd 分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[    2.940000] NAND device: Manufacturer ID: 0xc8, Chip ID: 0xd1 (ESMT NAND 128MiB 3,3V 8-bit), 128MiB, page size: 2048, OOB size: 64
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>[    2.950000] [NAND]select ecc bit:4, sparesize :64 spare_per_sector=16
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>[    2.950000] Scanning device for bad blocks
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>[    3.100000] Signature matched and data read!
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>[    3.110000] load_fact_bbt success 1023
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>...
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>[    3.190000] Creating 14 MTD partitions on &quot;MT7621-NAND&quot;:
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>[    3.190000] 0x000000000000-0x000007f80000 : &quot;ALL&quot;
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>[    3.200000] 0x000000000000-0x000000080000 : &quot;Bootloader&quot;
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>[    3.210000] 0x000000080000-0x0000000c0000 : &quot;Config&quot;
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>[    3.210000] 0x0000000c0000-0x000000100000 : &quot;Bdata&quot;
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>[    3.220000] 0x000000100000-0x000000140000 : &quot;Factory&quot;
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>[    3.230000] 0x000000140000-0x000000180000 : &quot;crash&quot;
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>[    3.230000] 0x000000180000-0x0000001c0000 : &quot;crash_syslog&quot;
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>[    3.240000] 0x0000001c0000-0x000000200000 : &quot;cfg_bak&quot;
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>[    3.240000] 0x000000200000-0x000000600000 : &quot;kernel0&quot;
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>[    3.250000] 0x000000600000-0x000000a00000 : &quot;kernel1&quot;
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>[    3.260000] 0x000000a00000-0x000002400000 : &quot;rootfs0&quot;
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>[    3.260000] 0x000002400000-0x000003e00000 : &quot;rootfs1&quot;
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>[    3.270000] 0x000003e00000-0x000006400000 : &quot;overlay&quot;
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>[    3.280000] 0x000006400000-0x000007f80000 : &quot;obr&quot;
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>[    3.280000] [mtk_nand] probe successfully!
</span></code></pre></div>
<p>通过 cat /proc/mtd，知道对应关系</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>root@XiaoQiang:/tmp# cat /proc/mtd
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>dev:    size   erasesize  name
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>mtd0: 07f80000 00020000 &quot;ALL&quot;
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>mtd1: 00080000 00020000 &quot;Bootloader&quot;
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>mtd2: 00040000 00020000 &quot;Config&quot;
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>mtd3: 00040000 00020000 &quot;Bdata&quot;
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>mtd4: 00040000 00020000 &quot;Factory&quot;
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>mtd5: 00040000 00020000 &quot;crash&quot;
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>mtd6: 00040000 00020000 &quot;crash_syslog&quot;
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>mtd7: 00040000 00020000 &quot;cfg_bak&quot;
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>mtd8: 00400000 00020000 &quot;kernel0&quot;
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>mtd9: 00400000 00020000 &quot;kernel1&quot;
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>mtd10: 01a00000 00020000 &quot;rootfs0&quot;
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>mtd11: 01a00000 00020000 &quot;rootfs1&quot;
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>mtd12: 02600000 00020000 &quot;overlay&quot;
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>mtd13: 01b80000 00020000 &quot;obr&quot;
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>mtd14: 00c1c000 0001f000 &quot;ubi_rootfs&quot;
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>mtd15: 021e8000 0001f000 &quot;data&quot;
</span></code></pre></div>
<p>备份，其中 Factory 中存储了 EEPROM 的数据</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>cat /dev/mtd4 &gt; Factory.dump
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>scp复制到本地
</span></code></pre></div>
<h4 id="5-设置环境变量">5. 设置环境变量<a class="headerlink" href="#5-设置环境变量" title="Permanent link">&para;</a></h4>
<p>设置环境变量（rm2100 有双系统用于备份保护，需要设置先启动哪一个）</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Enable uart and boot_wait, useful for testing or recovery if you have an uart adapter!</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">uart_en</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">boot_wait</span><span class="o">=</span>on
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">bootdelay</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1"># Set kernel1 as the booting kernel</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>nvram<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">flag_try_sys1_failed</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1"># Commit our nvram changes</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>nvram<span class="w"> </span>commit
</span></code></pre></div>
<h4 id="6-刷机">6. 刷机<a class="headerlink" href="#6-刷机" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>mtd<span class="w"> </span>write<span class="w"> </span>kernel1.bin<span class="w"> </span>kernel1
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>mtd<span class="w"> </span>-r<span class="w"> </span>write<span class="w"> </span>rootfs0.bin<span class="w"> </span>rootfs0
</span></code></pre></div>
<h3 id="mi-4a-千兆版">MI 4A 千兆版<a class="headerlink" href="#mi-4a-千兆版" title="Permanent link">&para;</a></h3>
<p>官方教程：<a href="https://openwrt.org/inbox/toh/xiaomi/xiaomi_mi_router_4a_gigabit_edition">[OpenWrt Wiki] Xiaomi Mi Router 4A Gigabit Edition</a></p>
<p><strong>warning</strong></p>
<ul>
<li>2022/10：v2版本的4A千兆版无法刷op。原版使用的是Winbond or GigaDevice 的 flash 芯片，我手头的是 GigaDevice 的<a href="https://www.tme.eu/en/details/gd25q127csig/serial-flash-memories-integrated-circ/gigadevice/">GD25Q127CSIG</a>。新版使用 Eon or CFeon 的芯片，还在支持中。</li>
<li>老版的有无线屏蔽，而在售的没有</li>
</ul>
<h4 id="说明">说明<a class="headerlink" href="#说明" title="Permanent link">&para;</a></h4>
<p>可以漏洞获取 shell，不必使用硬件编程器</p>
<p>2022/11/6日，因刷breed bootloader，使得 MI 4A 变砖。忠告：别用 breed，会变得不幸。（你 tm 支持 r3g，不支持 mi 4a 能不能写清楚）</p>
<h4 id="步骤">步骤<a class="headerlink" href="#步骤" title="Permanent link">&para;</a></h4>
<p>~~1. 首先需要使用<code>OpenWRTInvasion</code><strong>获取 shell</strong>。参考：<a href="https://github.com/acecilia/OpenWRTInvasion">acecilia/OpenWRTInvasion(github.com)</a>。</p>
<p>~~同时，该仓库也提供了获得 shell 后的刷机过程。不过使用官方的<code>OpenWRTInvasion</code>会从 github 上下载文件，而因为网络原因可能会失败。恩山论坛中有用户提供了修改代码的离线版本，可以搜索使用。
不过也可以自行修改代码：修改<code>script.sh</code>，将其中的链接替换成本地链接。可以使用 python -m http.server 运行一个小的 http 服务，提供下载。例：</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>curl<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;https://github.com/acecilia/OpenWRTInvasion/raw/master/script_tools/busybox-mipsel&quot;</span><span class="w"> </span>--insecure<span class="w"> </span>--output<span class="w"> </span>busybox
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1">#改为，ip 需要调整</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>curl<span class="w"> </span><span class="s2">&quot;http://192.168.31.189:8000/busybox-mipsel&quot;</span><span class="w"> </span>--output<span class="w"> </span>busybox
</span></code></pre></div>
<ol>
<li>现在官方仓库集成了本地服务器的功能，直接运行脚本即可。但是官方仓库却放弃了对 windows 的支持，不过亲测在 git bash 中运行没有问题，只需要把脚本开头的检测注释掉即可。</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a># if platform.system() == &quot;Windows&quot;:
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>#     sys.exit(&quot;Stopping: script can only be run on a Mac/Linux system&quot;)
</span></code></pre></div>
<ol>
<li>之后使用 telnet 进行连接，成功获得 shell 如图所示</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>telnet 192.168.31.1 #账号root, 密码root
</span></code></pre></div>
<p><img alt="image-20221030210955796" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/picgo/image-20221030210955796.png" />
3. 接着上传 openwrt 镜像 (使用 sysupgrade bin) 到路由器中，可以使用 python 搭建 http 文件服务器。最后运行 mtd 等待路由器重启完成即可。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>#window上, sysupgrade.bin所在目录
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>python -m http.server
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>#路由器上
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>cd /tmp
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>curl -O http://&lt;windows ip&gt;:8000/sysupgrade.bin
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>mtd -e OS1 -r write sysupgrade.bin OS1
</span></code></pre></div>
<h4 id="参考">参考<a class="headerlink" href="#参考" title="Permanent link">&para;</a></h4>
<p>breed 使用说明：<a href="https://www.sohu.com/a/304140654_120096961">https://www.sohu.com/a/304140654_120096961</a>
breed 刷 openwrt 教程 <a href="https://www.ixigua.com/6974624328725824031">https://www.ixigua.com/6974624328725824031</a></p>
<h4 id="eeprom-下载">EEPROM 下载<a class="headerlink" href="#eeprom-下载" title="Permanent link">&para;</a></h4>
<blockquote>
<p>eeprom 里有 mac 和 sn 等信息，如果 sn 丢失刷官方 bootloader 刷回原厂也不能绑定手机 app 的</p>
</blockquote>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4054821-1-1.html">【新提醒】[20210919 更新]小米路由 4A 千兆版 LEDE 固件_集成快乐上网、内网穿透、KMS、网络加速 - 小米无线路由器以及小米无线相关的设备 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></li>
</ul>
<blockquote>
<p>我看了下果然是错的，我之前也是这个情况，后来分析了下把 eeprom 用上了正确的就好了，你刷我这个 eeprom，如果还不行就刷我的解锁分区的 lede 固件，用 mtd 命令刷写，ssh 上路由，本地 scp 命令拷贝上传到 tmp 目录，<br />
  mtd -r write /tmp/eeprom.bin factory<br />
重启完了就 ok<br />
刷完 mac 会变，把你的 mac 地址改成你原来的 mac 地址。<br />
如果有原来的固件备份，发我我来帮你提取</p>
</blockquote>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-8252165-1-1.html">【新提醒】帮助提取 eeprom 小米 4A 千兆 (22 年 8 月新版)-小米无线路由器以及小米无线相关的设备 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></li>
</ul>
<h4 id="eeprom-修改">EEPROM 修改<a class="headerlink" href="#eeprom-修改" title="Permanent link">&para;</a></h4>
<p><a href="https://www.right.com.cn/forum/thread-384637-1-1.html">【新提醒】关于新 3(newifi 3) 的 eeprom 文件中 MAC-SN 等参数位置-newifi 无线路由器及网络设备 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<p>用 SSH 登录进入路由器的 Console 台后，用命令 (cat /proc/mtd)的输出中，Factory区对应的就是无线和MAC/SN等的配置文件。
这个文件备份出来后，大小为 64KB，可以在 breed 中更新 eeprom 处刷入路由器。</p>
<p>(下图为解锁后的输出)
用 WinHex 打开备份的文件 (假设为 eeprom.bin)</p>
<p>1)     路由器的 SN</p>
<p>路由器的 SN 号在路由器的背面贴纸处有，SN 的存储在这个文件中的偏移 0x7000(处)，格式为以 MND 开头，如下：</p>
<p>2)     路由器的 MAC 地址</p>
<p>路由器的 MAC 号在路由器的背面贴纸处有，MAC 的存储在这个文件中的偏移 0xE000(处)，格式为连续的两个 MAC 地址，共占 12 字节。
分别为起始”MAC 地址 - 结束 MAC 地址”, 结束 MAC 地址为起始 MAC 地址的最后一个字节内容 +2. 如图：
起始 MAC 地址：20 76 93 48 A9 1F (路由器背面处的贴纸)
结束 MAC 地址：20 76 93 48 A9 21</p>
<p>3)     和无线有关的参数</p>
<p>2.4G 无线的 BSSID 在文件开头偏移 0x4-0x9 处，总共 6 字节，如下图所示：</p>
<p>5G 无线的 BSSID 在偏移 0x8004-0x8009 处，总共 6 字节，(2.4G 无线的 BSSID 与 5G-BSSID 的最后一个字节内容相差 2)。如下图所示：</p>
<p>和无线有关的参数应该是在偏移 0x8000-0x80C0 处。看网友们改的话，都是在 0x8060-0x809F 这三行上修改，由于没有具体说明参数含义，因此不推荐自己修改。
如图所示：</p>
<p>4) 未知的内容</p>
<p>文件开头的 0x56-0x61 偏移处，一共 12 字节，分为 2 组。前 6 字节和后 6 字节内容也比较相似。不是 mac 也不是 bssid.</p>
<p>另外在偏移 0x8060-0x80A0 共 4 行内，有几个参数是以 5 个字节为一组的参数，具体格式特征如下：
00 00 26 xx xx, 或者 00 01 26 xx xx, 或者 00 02 26 xx xx 等。</p>
<p>建议：
    可以用其它人的 EEPROM 固件，仅仅修改 MAC 和 SN (可选：BSSID) 为自己的路由器的即可，不推荐自己修改无线参数部分内容。</p>
<h4 id="空间不足可以安装的软件">空间不足（可以安装的软件）<a class="headerlink" href="#空间不足可以安装的软件" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Configuring terminfo.
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>Configuring iputils-arping.
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Configuring libatomic1.
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>Configuring libiperf3.
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>Configuring kmod-netlink-diag.
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>Configuring libqrencode.
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>Configuring qrencode.
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>Configuring ss.
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>Configuring ethtool-full.
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>Configuring tree.
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>Configuring ip-bridge.
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>Configuring libncurses6.
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>Configuring libpcap1.
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>Configuring htop.
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>Configuring ncat.
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>Configuring mtr-json.
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>Configuring iperf3.
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>Collected errors:
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a> * verify_pkg_installable: Only have 140kb available on filesystem /overlay, pkg vim-full needs 776
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a> * opkg_install_cmd: Cannot install package vim-full.
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a> * verify_pkg_installable: Only have 140kb available on filesystem /overlay, pkg tmux needs 238
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a> * opkg_install_cmd: Cannot install package tmux.
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a> * wfopen: //usr/lib/opkg/info/terminfo.control: No space left on device.
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a> * wfopen: //usr/lib/opkg/info/terminfo.postinst: No space left on device.
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a> * wfopen: //usr/lib/opkg/info/terminfo.prerm: No space left on device.
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a> * wfopen: /usr/share/terminfo/a/ansi: No space left on device.
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a> * wfopen: /usr/share/terminfo/d/dumb: No space left on device.
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a> * wfopen: /usr/share/terminfo/l/linux: No space left on device.
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a> * wfopen: /usr/share/terminfo/r/rxvt: No space left on device.
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a> * wfopen: /usr/share/terminfo/r/rxvt-unicode: No space left on device.
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a> * wfopen: /usr/share/terminfo/s/screen: No space left on device.
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a> * wfopen: /usr/share/terminfo/s/screen-256color: No space left on device.
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a> * verify_pkg_installable: Only have 164kb available on filesystem /overlay, pkg tcpdump needs 281
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a> * opkg_install_cmd: Cannot install package tcpdump.
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a> * verify_pkg_installable: Only have 164kb available on filesystem /overlay, pkg ip-full needs 168
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a> * opkg_install_cmd: Cannot install package ip-full.
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a> * verify_pkg_installable: Only have 168kb available on filesystem /overlay, pkg libopenssl1.1 needs 966
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a> * opkg_install_cmd: Cannot install package bind-dig.
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a> * verify_pkg_installable: Only have 168kb available on filesystem /overlay, pkg file needs 193
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a> * opkg_install_cmd: Cannot install package file.
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a> * opkg_conf_write_status_files: Couldn&#39;t close //usr/lib/opkg/status: No space left on device.
</span></code></pre></div>
<p>由于没有完成配置，安装失败的软件不会出现在 opkg list-installed 中。</p>
<p>两次 opikg install 都失败后，opkg 开始 segmentfault 了</p>
<p><a href="https://forum.archive.openwrt.org/viewtopic.php?id=13171">OpenWrt Forum Archive</a></p>
<p>解决办法只有 upgrade 并选择保存配置了。</p>
<p>安装 23.05 并安装 wiregurad 后剩余空间</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>root@mi4a:~# df -h
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>Filesystem                Size      Used Available Use% Mounted on
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>/dev/root                 3.8M      3.8M         0 100% /rom
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>tmpfs                    58.8M      1.1M     57.7M   2% /tmp
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>/dev/mtdblock10           8.3M    512.0K      7.8M   6% /overlay
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>overlayfs:/overlay        8.3M    512.0K      7.8M   6% /
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>tmpfs                   512.0K         0    512.0K   0% /dev
</span></code></pre></div>
<p>几个大软件
- bash: 359KB
- zsh: 1.8MB
- vim-full: 900KB
- tmux: 400KB
- tcpdump 400KB</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>iputils-arping ncat iperf3 curl mtr-json htop tcpdump tmux
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>root@mi4a:~# df -h
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>Filesystem                Size      Used Available Use% Mounted on
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>/dev/root                 3.8M      3.8M         0 100% /rom
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>tmpfs                    58.8M      1.1M     57.7M   2% /tmp
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>/dev/mtdblock10           8.3M      2.1M      6.2M  25% /overlay
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>overlayfs:/overlay        8.3M      2.1M      6.2M  25% /
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>tmpfs                   512.0K         0    512.0K   0% /dev
</span></code></pre></div>
<h3 id="mi-r3g">MI R3G<a class="headerlink" href="#mi-r3g" title="Permanent link">&para;</a></h3>
<p>官方教程：[<a href="https://openwrt.org/toh/xiaomi/mir3g">OpenWrt Wiki] Xiaomi Mi WiFi R3G (Mi Wifi Router 3G / MIR3G / MI3G / mi4a Gigabit)</a></p>
<p>r3g 官方固件下载：<a href="https://firmware-selector.openwrt.org/?version=21.02.3&amp;target=ramips%2Fmt7621&amp;id=xiaomi_mi-router-3g">OpenWrt Firmware Selector</a></p>
<h4 id="准备">准备<a class="headerlink" href="#准备" title="Permanent link">&para;</a></h4>
<ul>
<li>FAT32 格式 U 盘</li>
<li>一枚针用于戳路由器 reset 键</li>
<li>手机安装 MIWIFI app</li>
</ul>
<h4 id="开启-ssh">开启 ssh<a class="headerlink" href="#开启-ssh" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>更新为小米开发版固件：<a href="https://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_12f97_2.25.124.bin">https://bigota.miwifi.com/xiaoqiang/rom/r3g/miwifi_r3g_firmware_12f97_2.25.124.bin</a></p>
</li>
<li>
<p><strong>下载小米路由器手机客户端 (应用商店 MI WIFI) 软件，绑定路由器</strong></p>
</li>
<li>
<p>根据 <a href="https://d.miwifi.com/rom/ssh，开启">https://d.miwifi.com/rom/ssh，开启</a> SSH</p>
<p><em>p.s. 1. 即使是同一型号，miwifi_ssh.bin 也是不同的；2. ssh 密码显示在该页面</em></p>
<ol>
<li>请将下载的工具包 bin 文件复制到 U 盘（FAT/FAT32 格式）的根目录下，保证文件名为 miwifi_ssh.bin；</li>
<li>断开小米路由器的电源，将 U 盘插入 USB 接口；</li>
<li>按住 reset 按钮之后重新接入电源，指示灯变为黄色闪烁状态即可松开 reset 键；</li>
<li>等待 3-5 秒后安装完成之后，小米路由器会自动重启，之后您就可以尽情折腾啦：）</li>
</ol>
</li>
</ol>
<h4 id="备份">备份<a class="headerlink" href="#备份" title="Permanent link">&para;</a></h4>
<p>查看 mtd 分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>root@XiaoQiang:~# cat /proc/mtd
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>dev:    size   erasesize  name
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>mtd0: 07f80000 00020000 &quot;ALL&quot;
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>mtd1: 00080000 00020000 &quot;Bootloader&quot;
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>mtd2: 00040000 00020000 &quot;Config&quot;
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>mtd3: 00040000 00020000 &quot;Bdata&quot;
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>mtd4: 00040000 00020000 &quot;Factory&quot;
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>mtd5: 00040000 00020000 &quot;crash&quot;
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>mtd6: 00040000 00020000 &quot;crash_syslog&quot;
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>mtd7: 00040000 00020000 &quot;reserved0&quot;
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>mtd8: 00400000 00020000 &quot;kernel0&quot;
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>mtd9: 00400000 00020000 &quot;kernel1&quot;
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>mtd10: 02000000 00020000 &quot;rootfs0&quot;
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>mtd11: 02000000 00020000 &quot;rootfs1&quot;
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>mtd12: 03580000 00020000 &quot;overlay&quot;
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>mtd13: 012a6000 0001f000 &quot;ubi_rootfs&quot;
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>mtd14: 030ec000 0001f000 &quot;data&quot;
</span></code></pre></div>
<p>备份 factory 分区</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>cat /dev/mtd4 &gt; /tmp/factory.bin
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>#on windows
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>scp root@192.168.33.193:/tmp/factory.bin .
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>scp root@192.168.33.228:/tmp/factory.bin .
</span></code></pre></div>
<h4 id="刷-openwrt">刷 openwrt<a class="headerlink" href="#刷-openwrt" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>mtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-kernel1.bin kernel1
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>mtd write openwrt-18.06.2-ramips-mt7621-mir3g-squashfs-rootfs0.bin rootfs0
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>nvram set flag_try_sys1_failed=1
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>nvram commit
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>reboot
</span></code></pre></div>
<h3 id="ax6s">AX6S<a class="headerlink" href="#ax6s" title="Permanent link">&para;</a></h3>
<h4 id="步骤_1">步骤<a class="headerlink" href="#步骤_1" title="Permanent link">&para;</a></h4>
<p><a href="https://openwrt.org/toh/xiaomi/ax3200">[OpenWrt Wiki] Xiaomi AX3200 / Redmi AX6S</a>
<a href="https://github.com/YangWang92/AX6S-unlock">YangWang92/AX6S-unlock (github.com)</a>
<a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=8187405">[2-2]AX6S 闭源无线驱动Openwrt 刷机教程/固件下载-小米无线路由器及小米网络设备-恩山无线论坛 (right.com.cn)</a></p>
<ul>
<li>
<p>telnet 后手动开启 ssh</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>/etc/init.d/dropbear start
</span></code></pre></div>
<p>​ tips: 使用 git-bash 版本的 ssh 连接报错。使用 cmd 的 ssh 可以。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>Unable to negotiate with 192.168.31.1 port 22: no matching host key type found. Their offer: ssh-rsa
</span></code></pre></div>
</li>
</ul>
<ul>
<li>
<p>必须添加 boot_fw1 改行，否则重启后进入原系统。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>nvram set ssh_en=1
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>nvram set uart_en=1
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>nvram set boot_wait=on
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>nvram set flag_boot_success=1
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>nvram set flag_try_sys1_failed=0
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>nvram set flag_try_sys2_failed=0
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>nvram set &quot;boot_fw1=run boot_rd_img;bootm&quot;
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>nvram commit
</span></code></pre></div>
</li>
</ul>
<ul>
<li>刷写 factory.bin-&gt; firmware 分区</li>
</ul>
<p>AX6S 为国内版，国外版称为 AX3200</p>
<ul>
<li>SoC：<strong>MT7622</strong>B: 2 x <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#65;&#53;&#51;&#64;&#49;&#46;&#51;&#53;&#71;&#72;&#122;">&#65;&#53;&#51;&#64;&#49;&#46;&#51;&#53;&#71;&#72;&#122;</a> CPU。<ul>
<li>满血版本是 MT7622A，少了蓝牙就是 MT7622BV，没有蓝牙和多媒体功能的是 MT7622B，基本剩下无线功能的是 MT7622E</li>
</ul>
</li>
<li>ram: 256 + flash: 128</li>
<li><a href="https://openwrt.org/toh/xiaomi/ax3200">[OpenWrt Wiki] Xiaomi AX3200 / Redmi AX6S</a></li>
</ul>
<h4 id="坑sysupgrade-变砖">坑：sysupgrade 变砖<a class="headerlink" href="#坑sysupgrade-变砖" title="Permanent link">&para;</a></h4>
<p>不知道为什么 wifi 下载速度只能跑到 100Mbps，win11 中显示链接速度一边很低。因此想要升级下系统。</p>
<p>2024-06-02 从 22 升级到 23.05.3 后，机器启动一直反复黄灯。升级时保留了配置。暂时不清楚是什么原因</p>
<p>发现是个普遍问题，官方文档里写了。</p>
<p><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=8215037&amp;extra=page=2&amp;filter=typeid&amp;typeid=94&amp;page=1">AX6S刷OP必砖-小米无线路由器及小米网络设备-恩山无线论坛 (right.com.cn)</a>
<a href="https://openwrt.org/toh/xiaomi/ax3200#upgrading_openwrt">https://openwrt.org/toh/xiaomi/ax3200#upgrading_openwrt</a>
<a href="https://www.right.com.cn/forum/thread-8199483-1-1.html">AX6s 变砖了，有大神可以看看如何救砖吗？-小米无线路由器及小米网络设备-恩山无线论坛 (right.com.cn)</a></p>
<p>救砖</p>
<ul>
<li>小米官方工具：没显示支持红米 ax6s。但是有人说可以，有人说不可以</li>
<li>op 官方教程中的 tftp 恢复<ul>
<li>中文提到了设置 dhcp server start 192.168.31.2，长度为1：<a href="https://www.right.com.cn/forum/thread-8199483-1-1.html">AX6s 变砖了，有大神可以看看如何救砖吗？-小米无线路由器及小米网络设备-恩山无线论坛 (right.com.cn)</a></li>
<li>tftpd 软件没有 start 按钮，配置 dhcp server 和 tftp server 即可。</li>
</ul>
</li>
<li>就算使用编程器，是 WSON 接口，也没法使用夹子。因此必须焊接，而我没器材，也不太会。</li>
</ul>
<p>结果两个方法对我都没用。</p>
<p><strong>发现问题在于把 mesh 按钮看成了 reset 键</strong>。导致第一步进入 reset 模式就失败了，网卡没有初始化，PC 上显示为未连接。（为了发现这一点对“reset”后黄灯的亮的规律进行了计时，发现按不按，都是12s左右灭一次）</p>
<p>正确的按 reset 后，通过 tftp 方法恢复了原厂系统。</p>
<p>之后通过 telnet 的方式，刷入了 23.5.2 的 factory。恢复 backup 的配置，就回到了之前的状态。</p>
<h3 id="竞斗云-20pw">竞斗云 2.0（P&amp;W)<a class="headerlink" href="#竞斗云-20pw" title="Permanent link">&para;</a></h3>
<h4 id="资料">资料<a class="headerlink" href="#资料" title="Permanent link">&para;</a></h4>
<p><a href="https://openwrt.org/toh/p_w/r619ac">[OpenWrt Wiki] P&amp;W R619AC</a></p>
<h4 id="教程">教程<a class="headerlink" href="#教程" title="Permanent link">&para;</a></h4>
<p>需要先刷入 opboot（一个第三方 bootloader）<a href="https://www.red-yellow.net/竞斗云2刷opboot.html">竞斗云 2 刷 opboot - 路由智态 (red-yellow.net)</a></p>
<p>然后再刷 openwrt。
编译：<a href="https://www.red-yellow.net/%e7%ab%9e%e6%96%97%e4%ba%912%e7%9a%84openwrt%e5%9b%ba%e4%bb%b6.html">竞斗云 2 的 OpenWrt 固件 - 路由智态 (red-yellow.net)</a>
刷的这里作者提供的 immortalwrt：<a href="https://www.right.com.cn/forum/thread-4061585-1-1.html">【新提醒】【2023-6-13】竞斗云 2.0P&amp;W-R619AC OPENWRT 固件 | 插件全面 | 多版本-OPENWRT 专版 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<p>之前使用 switch 官方固件 22.03，看到 device 有 eth0, eth1，然后 switch 界面可以设置 4 个 lan 口
但是问题是只要一改动 vlan 设置，通过 wan 口（开启 192.168.99.0 的 dhcp）访问 p2w 就会掉</p>
<p>后面刷了一个其它人编译的 immortalwrt 固件，发现其实只有一个 eth0。wan 口 eth0.2 是一个 vlan。switch 界面有 4 个 lan 和 1 个 wan 可以配置。
这下配置 switch vlan 异常稳定顺畅
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/vlan-plan.jpg" /></p>
<p>这里 CPU 端口的 tag 和 untag</p>
<ul>
<li>设置为 off，则不存在 eth0.3 设备</li>
<li>设置为 tag 则 eth0.3 上 tcpdump 能收到很多包</li>
<li>设置为 untag，则收不到包</li>
</ul>
<p>收到的包其实只有广播等情况，否则包直接从特定端口出去了，不会往其它端口发。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>root@p2w:~# tcpdump -ni eth0.3 host 114.214.236.72
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>listening on eth0.3, link-type EN10MB (Ethernet), capture size 262144 bytes
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>q01:50:16.005639 IP 114.214.236.72.45520 &gt; 239.255.255.250.1900: UDP, length 94
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>01:50:16.006412 ARP, Request who-has 114.214.236.74 tell 114.214.236.72, length 46
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>01:50:16.173072 ARP, Request who-has 114.214.236.96 tell 114.214.236.72, length 46
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>01:50:16.926278 ARP, Request who-has 114.214.236.200 tell 114.214.236.72, length 46
</span></code></pre></div>
<h4 id="遇到问题">遇到问题<a class="headerlink" href="#遇到问题" title="Permanent link">&para;</a></h4>
<p>经常性的掉网络，研究后发现是 ap 的 br-lan 和上游无法连接了。通过无线手动设置静态 ip 可以连上 p2w。尝试 ping 网关地址，发现 eth0.1 上能抓到 arp 包，但是上游对应 bridge 却抓不到。反过来，上游 arping ap 地址，ap 也收不到包。</p>
<ul>
<li>测试如果把连接 ap 的网线连接笔记本，网络是正常的，因此排除上游问题。</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>arping -i interface 测试二层是否通
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>arp查看当前mac表
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>tcpdump -ni eth0.1 arp
</span></code></pre></div>
<p>没办法，不知如何解决，只好重装了官方 22.03.5 的系统。官方系统把 wan 单独拿了出来作为 eth1，而 switch 界面可以配置 eth0 和剩余四个端口</p>
<h3 id="360-t7">360 T7<a class="headerlink" href="#360-t7" title="Permanent link">&para;</a></h3>
<h4 id="基本参数">基本参数<a class="headerlink" href="#基本参数" title="Permanent link">&para;</a></h4>
<p>mt7681:<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#50;&#120;&#65;&#53;&#51;&#64;&#49;&#46;&#51;&#71;&#72;&#122;">&#50;&#120;&#65;&#53;&#51;&#64;&#49;&#46;&#51;&#71;&#72;&#122;</a>
256 RAM+ 128 NAND</p>
<p>价格</p>
<ul>
<li>原版 118x2 包邮，魔改 512 内存版：150</li>
</ul>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815125432.png" /></p>
<p>待机 60 多度有毒，看来还是需要自己加散热片</p>
<p>40(30，最小覆盖两个的距离) x25（深度 10mm）</p>
<ul>
<li>13x7</li>
<li>12x13
25x25</li>
<li>10x12
30x25（深度：15mm）</li>
<li>13x14</li>
</ul>
<p>单个芯片：14x14
整个盖住：25x25，30x20</p>
<p><a href="https://cmi.hanwckf.top/">hanwckf's blog</a>
<a href="https://qust.me/post/360t7-openwrt/">360 T7 刷 openwrt 教程｜最强的百元路由器 | 酱紫表 (qust.me)</a>
<a href="https://www.right.com.cn/forum/thread-8263290-1-1.html">【新提醒】360T7 openwrt 固件发布，感谢 H 大-OPENWRT 专版 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
提到了 ipv6 + wiregaurd + hnat 有问题？<a href="https://www.v2ex.com/t/930398">[避坑] 360T7 - V2EX</a></p>
<h4 id="准备_1">准备<a class="headerlink" href="#准备_1" title="Permanent link">&para;</a></h4>
<p>硬件</p>
<ul>
<li>拆机工具：螺丝刀，撬片（没它真打不开）</li>
<li>usb 转 ttl 模块，杜邦线公对母</li>
</ul>
<p>软件</p>
<ul>
<li>putty 等串口软件</li>
<li>修改版 uboot：<a href="https://github.com/hanwckf/bl-mt798x/releases/tag/20230727">Release 20230727 · hanwckf/bl-mt798x (github.com)</a></li>
<li>固件：237, immortal 原版</li>
<li>可能需要：旧版原厂固件，新版固件关闭了 failsafe 模式<a href="https://github.com/hqvv/360T7">hqvv/360T7: qihoo 360T7 resources and official firmware (github.com)</a></li>
<li>可选，windows netcat，用于在 failsafe 模式下备份路由器 flash。</li>
</ul>
<h4 id="1-拆机和-ttl-模块连接">1. 拆机和 TTL 模块连接<a class="headerlink" href="#1-拆机和-ttl-模块连接" title="Permanent link">&para;</a></h4>
<p>拆机注意：</p>
<ul>
<li>路由器只有两个螺丝，都被背面贴纸盖住了</li>
<li>一共有 2+8 个卡口，非常难拆。优先从路由器下方撬开，然后再两侧，最后上侧比较容易。<ul>
<li>视频参考：<a href="https://www.bilibili.com/video/BV1GV4y1P74A/?spm_id_from=333.880.my_history.page.click">360T7 第二部分拆机_哔哩哔哩_bilibili</a></li>
</ul>
</li>
</ul>
<p>TTL 模块连接
板子左上角四个触孔，从上到下：RX, TX, GND。<strong>波特率 115200</strong></p>
<ul>
<li>注意，对应 TTL 模块一侧，RX 需要对应 TX，TX 对应 RX</li>
</ul>
<h4 id="2-ttl-进入-failsafe-模式开启-telnet">2. TTL 进入 failsafe 模式开启 telnet<a class="headerlink" href="#2-ttl-进入-failsafe-模式开启-telnet" title="Permanent link">&para;</a></h4>
<p>原理</p>
<ul>
<li>原系统使用 uboot，但是关闭了 uboot 菜单，开机后会直接引导内核</li>
<li>原系统引导过程中支持 failsafe 模式，进入后可以 mount_root，对文件系统进行修改，从而可以开启 telnet</li>
</ul>
<p>过程</p>
<ul>
<li>连接好串口，并打开 putty 后，插电开机，路由器启动并输出信息</li>
<li>在引导内核过程中，会出现进入 failsafe 提示，按 f+enter 即可进入。大概有 3 秒等待时间。<ul>
<li>如果没出现，需要降级原系统。<a href="https://www.right.com.cn/forum/thread-8297040-1-1.html">【新提醒】360t7m(t7 移动定制版) 无法进入 failsafe 模式-OPENWRT 专版 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a>
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815140202.png" /></li>
</ul>
</li>
</ul>
<p>进入后</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># 开启uboot控制台菜单</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>fw_setenv<span class="w"> </span>bootmenu_delay<span class="w"> </span><span class="m">3</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c1"># 挂载rootfs并开启telnet</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>mount_root
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/.*local debug=.*/\tlocal debug=1/&#39;</span><span class="w"> </span>/etc/init.d/telnet
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="c1"># 修改root密码</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>passwd<span class="w"> </span>root
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="c1"># 重启</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>reboot
</span></code></pre></div>
<p>可以选择备份固件</p>
<ul>
<li>注意千万不要 ping，否则无法 ctrl-c</li>
<li>nc 结束后会自动退出，128MB 的 flash 不到 1 分钟能够下载完。</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># 将电脑的IP地址设置为192.168.1.8，插入路由器LAN口</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c1"># 使用nc监听3333端口并写入all.bin</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c1"># Windows系统可以使用netcat</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1"># nc -l -p 3333 &gt; all.bin</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1"># 在路由器failsafe模式下开启网络</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">0</span>.0.0.0
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>brctl<span class="w"> </span>addbr<span class="w"> </span>br-lan
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>ifconfig<span class="w"> </span>br-lan<span class="w"> </span><span class="m">192</span>.168.1.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span>up
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>brctl<span class="w"> </span>addif<span class="w"> </span>br-lan<span class="w"> </span>eth0
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c1"># 读取/dev/mtd0，使用nc发送到192.168.1.8:3333</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>cat<span class="w"> </span>/dev/mtd0<span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span><span class="m">192</span>.168.1.8<span class="w"> </span><span class="m">3333</span>
</span></code></pre></div>
<h4 id="3-刷改版-uboot-并刷固件">3. 刷改版 uboot 并刷固件<a class="headerlink" href="#3-刷改版-uboot-并刷固件" title="Permanent link">&para;</a></h4>
<p>改版 uboot 功能详细介绍：<a href="https://cmi.hanwckf.top/p/mt798x-uboot-usage/">mt798x uboot 功能介绍 (hanwckf.top)</a></p>
<ul>
<li>如果使用原版 uboot，则固件大小最多只能使用 36MB，改版支持 108MB</li>
<li>支持 webui 方便刷固件</li>
</ul>
<p>步骤</p>
<ul>
<li>上一步开启 telnet 后，正常重启系统</li>
<li>telnet 连接路由器，root 用户名，密码为上一步修改的密码</li>
<li>本地 python 搭建一个 http 服务，路由器上通过 wget 下载改版 uboot</li>
<li>
<p>刷写</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>mtd write 360t7-fip-fixed-parts.bin fip
</span></code></pre></div>
</li>
</ul>
<ul>
<li>按住 reset 键，插上路由器电源，保持 3 秒左右，灯变为绿色</li>
<li>设置静态 ip 192.168.1.2，即可打开路由器 web 界面。</li>
<li>选择固件上传即可（需要对应改版 uboot 分区格式的）</li>
</ul>
<h4 id="性能问题">性能问题<a class="headerlink" href="#性能问题" title="Permanent link">&para;</a></h4>
<h5 id="wifi-跑不到千兆">wifi 跑不到千兆<a class="headerlink" href="#wifi-跑不到千兆" title="Permanent link">&para;</a></h5>
<p>360t7, QWRT</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>NAME=&quot;OpenWrt&quot;
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>VERSION=&quot;SNAPSHOT&quot;
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>ID=&quot;openwrt&quot;
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>ID_LIKE=&quot;lede openwrt&quot;
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>PRETTY_NAME=&quot;OpenWrt SNAPSHOT&quot;
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>VERSION_ID=&quot;snapshot&quot;
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>HOME_URL=&quot;https://openwrt.org/&quot;
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>BUG_URL=&quot;https://bugs.openwrt.org/&quot;
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>SUPPORT_URL=&quot;https://forum.openwrt.org/&quot;
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>BUILD_ID=&quot;r5044-12209a7f2&quot;
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>OPENWRT_BOARD=&quot;mediatek/mt7981&quot;
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>OPENWRT_ARCH=&quot;aarch64_cortex-a53&quot;
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>OPENWRT_TAINTS=&quot;no-all&quot;
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>OPENWRT_DEVICE_MANUFACTURER=&quot;OpenWrt&quot;
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>OPENWRT_DEVICE_MANUFACTURER_URL=&quot;https://openwrt.org/&quot;
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>OPENWRT_DEVICE_PRODUCT=&quot;Generic&quot;
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>OPENWRT_DEVICE_REVISION=&quot;v0&quot;
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>OPENWRT_RELEASE=&quot;OpenWrt SNAPSHOT r5044-12209a7f2&quot;
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>root@360T7 ➜  ~ uname -r
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>5.4.243
</span></code></pre></div>
<p>无线极限速率</p>
<p>cpu 占用 150%</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>root@360T7 ➜  ~ iperf3 -c 192.168.35.135
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>[  5]   0.00-10.00  sec  1.12 GBytes   962 Mbits/sec  310             sender
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>[  5]   0.00-10.00  sec  1.12 GBytes   962 Mbits/sec                  receiver
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>root@360T7 ➜  ~ iperf3 -c 192.168.35.135 -P 4
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>[  5]   0.00-10.00  sec   438 MBytes   368 Mbits/sec  1219             sender
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>[  5]   0.00-10.01  sec   438 MBytes   367 Mbits/sec                  receiver
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>[  7]   0.00-10.00  sec   278 MBytes   234 Mbits/sec  201             sender
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>[  7]   0.00-10.01  sec   278 MBytes   233 Mbits/sec                  receiver
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>[  9]   0.00-10.00  sec   174 MBytes   146 Mbits/sec  275             sender
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>[  9]   0.00-10.01  sec   174 MBytes   145 Mbits/sec                  receiver
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>[ 11]   0.00-10.00  sec   311 MBytes   261 Mbits/sec  1025             sender
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>[ 11]   0.00-10.01  sec   311 MBytes   260 Mbits/sec                  receiver
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>[SUM]   0.00-10.00  sec  1.17 GBytes  1.01 Gbits/sec  2720             sender
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>[SUM]   0.00-10.01  sec  1.17 GBytes  1.01 Gbits/sec                  receiver
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>root@360T7 ➜  ~ iperf3 -c 192.168.35.135 -R
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>[ ID] Interval           Transfer     Bitrate
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>[  5]   0.00-10.00  sec   816 MBytes   684 Mbits/sec                  sender
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>[  5]   0.00-10.00  sec   815 MBytes   683 Mbits/sec                  receiver
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.1
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>[ ID] Interval           Transfer     Bitrate
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>[  5]   0.00-10.00  sec  1.08 GBytes   930 Mbits/sec                  sender
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>[  5]   0.00-10.02  sec  1.08 GBytes   927 Mbits/sec                  receiver
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.1 -R
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>[  5]   0.00-10.02  sec  1.05 GBytes   900 Mbits/sec   30             sender
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>[  5]   0.00-10.00  sec  1.05 GBytes   900 Mbits/sec                  receiver
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.253
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>[ ID] Interval           Transfer     Bitrate
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>[  5]   0.00-10.00  sec   820 MBytes   688 Mbits/sec                  sender
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>[  5]   0.00-10.01  sec   820 MBytes   688 Mbits/sec                  receiver
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.253 -R
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>[  5]   0.00-10.01  sec  1.18 GBytes  1.01 Gbits/sec   22             sender
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>[  5]   0.00-10.00  sec  1.18 GBytes  1.01 Gbits/sec                  receiver
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.2
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>[ ID] Interval           Transfer     Bitrate
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>[  5]   0.00-10.00  sec  1.08 GBytes   924 Mbits/sec                  sender
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>[  5]   0.00-10.07  sec  1.08 GBytes   918 Mbits/sec                  receiver
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a>$ iperf3.exe -B 192.168.35.135 -c 192.168.35.2 -R
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a>[  5]   0.00-10.05  sec   657 MBytes   548 Mbits/sec   16             sender
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a>[  5]   0.00-10.00  sec   653 MBytes   548 Mbits/sec                  receiver
</span></code></pre></div>
<h4 id="固件选择">固件选择<a class="headerlink" href="#固件选择" title="Permanent link">&para;</a></h4>
<h5 id="mtwifi-闭源驱动">mtwifi 闭源驱动<a class="headerlink" href="#mtwifi-闭源驱动" title="Permanent link">&para;</a></h5>
<p><a href="https://www.right.com.cn/forum/thread-8263340-1-1.html">恩山 237 大佬固件</a></p>
<ul>
<li>Hanwckf 的源码 +18.06 软件包</li>
<li>支持 802.11 k/v/r 无缝漫游、硬件 QOS 等功能</li>
<li>通过 uboot 刷入过程中，不知为何刷完重启后灯灭了一段时间。刚开始还以为是进不了系统，但是后面发现没问题的。</li>
<li>界面主题是 design，确实很好看</li>
<li>致命问题：由于是自编译，无法安装 wireguard</li>
<li>第二个严重问题：没有使用 wpad，而是使用 luci-app-mtk 管理无线，这导致配置 FT 没法</li>
</ul>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230818012311.png" /></p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230818012256.png" /></p>
<p><a href="https://github.com/hanwckf/immortalwrt-mt798x">hanwckf/immortalwrt-mt798x (github.com)</a></p>
<ul>
<li><a href="https://cmi.hanwckf.top/p/immortalwrt-mt798x/">immortalwrt-mt798x 项目介绍 (hanwckf.top)</a></li>
</ul>
<p>QWRT(lean)
<a href="https://www.right.com.cn/forum/thread-8283847-1-1.html">【新提醒】潘多拉 QWRT MT7981 360T7 R23.5.4 高性能闭源固件发布（原生无线配置）-OPENWRT 专版 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<ul>
<li>lua 界面</li>
<li>原版无线配置</li>
</ul>
<p>加群后，群主告诉我，闭源驱动只能和闭源驱动组 mesh，并且也不太支持 802.11r。</p>
<p>ImmortalwrtARM
<a href="https://www.right.com.cn/forum/thread-5053708-1-1.html">【新提醒】【2023-08-12】小米 WR30U 闭源驱动 immortalwrt 固件 - 小米无线路由器以及小米无线相关的设备 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<ul>
<li><a href="https://www.v2ex.com/t/930398">[避坑] 360T7 - V2EX</a> 在这里看到说 padavanonly/immortalwrtARM FT 正常</li>
</ul>
<h5 id="不确定">不确定<a class="headerlink" href="#不确定" title="Permanent link">&para;</a></h5>
<p><a href="https://firmware-selector.immortalwrt.org/?version=23.05.0-rc3&amp;target=mediatek%2Ffilogic&amp;id=qihoo_360t7-ubootmod">原版 immortalwrt</a></p>
<ul>
<li>使用了下发现 wan 口设置 dhcp 刚开始总有问题，虽然最后通过手动重启 dnsmasq 方式解决了，但是确实不是很顺利。</li>
</ul>
<p>自编译</p>
<p>大佬你好。我购买了 360T7 和 wr30u 来对家中网络进行升级。但是由于这两个都没有官方 openwrt 支持，我用的都是别人编译的版本。
360T7 用的是这个<a href="https://github.com/hanwckf/immortalwrt-mt798x">hanwckf/immortalwrt-mt798x (github.com)</a>，但是它的无限配置是 luci-app-mtk，我找不到 802.11r 的配置选项。
wr30u 用的是这个(QWRT) <a href="https://www.right.com.cn/forum/thread-8284824-1-1.html，它有">https://www.right.com.cn/forum/thread-8284824-1-1.html，它有</a> 802.11r 但是却啥都不能设置，我查看日志看到 FT 会有 The PMKID is invalid 错误。现象就是连上它之后压根不会漫游，甚至强度低于 -80db 了都不会，只能手动断开 wifi 重连。</p>
<p>看到你测试了无线开源和闭源的固件，我想问下开源的固件在那找。我不需要最强的性能，我只想要它的设置和官方 openwrt 一样，可以一起工作就行。😭</p>
<p>注：家中网络原本是 ax6s(做 ac）+3 R3g（ap），802.11r 工作得很正常。</p>
<h3 id="小米-wr30u">小米 WR30U<a class="headerlink" href="#小米-wr30u" title="Permanent link">&para;</a></h3>
<p>参考资料：</p>
<ul>
<li>一个比较广泛的教程：<a href="https://blog.qust.me/wr30u">小米 WR30U 解锁 SSH 刷 openwrt，最有性价比的百元路由器 (qust.me)</a></li>
<li>恢复原厂固件几种方法：<a href="https://www.right.com.cn/forum/thread-8291160-1-1.html">【新提醒】小米 WR30U 恢复原厂固件的几种方法 - 小米无线路由器以及小米无线相关的设备 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a><ul>
<li>hanwckf 的多分区 uboot，直接支持原厂。先刷入 uboot，然后 web 刷原厂 mtd8 备份</li>
<li>mtd 覆盖整个 mtd0</li>
<li>ttl 中断 uboot，tftp 下载 flash 备份，然后刷</li>
</ul>
</li>
</ul>
<p>想从 QWRT 刷成主线 openwrt，刷了 FIP 分区和 ubi 分区（刷了 ubootmod 和对应固件），结果把 WR30U 刷坏了。详细见 WR30U 救砖
原本的 QWRT 应该使用的是 hanwckf's uboot(immortalwrt-112m)</p>
<h4 id="刷机">刷机<a class="headerlink" href="#刷机" title="Permanent link">&para;</a></h4>
<p>使用 hanwckf's 大佬提供的 bl-mt798x uboot 支持多种机型 + 分区格式：<a href="https://cmi.hanwckf.top/p/mt798x-uboot-usage/">mt798x uboot 功能介绍 (hanwckf.top)</a></p>
<p>bl-mt798x 项目基于 mtk 原厂提供的 ATF 及 uboot 源码，特点如下</p>
<ul>
<li>uboot 自带 mtk 原厂开发的简易 webui 恢复界面，可以通过 webui 直接刷入固件或者更新 uboot，也可以使用串口+TFTP 刷入固件</li>
<li>支持多种 Flash 分区布局切换功能（仅支持 spi-nand），可以在 webui 中切换不同的分区布局，完美兼容小米原厂固件</li>
</ul>
<p>hanwckf 的 uboot 支持多种 dts 布局，可以引导不同的固件（包含官方固件）。但是需注意</p>
<ul>
<li>uboot 支持刷入小米原厂 mtd8/mtd9 备份文件（可从<a href="https://github.com/hanwckf/xiaomi-router-stock-ubi-bin">此处</a>下载），不支持<code>miwifi.com</code>官网下载的固件</li>
<li>由于 OpenWrt 主线的 ubootmod 固件未开启 nmbm 支持，因此<strong>不支持任何 ubootmod 分区布局的主线固件</strong>（包括 OpenWrt, X-Wrt 等带有 ubootmod 字样的固件），请使用 OpenWrt 主线提供的 uboot 启动 ubootmod 固件</li>
</ul>
<table>
<thead>
<tr>
<th>固件类型</th>
<th>uboot (default)</th>
<th>uboot (immortalwrt-112m)</th>
<th>uboot (qwrt)</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/hanwckf/xiaomi-router-stock-ubi-bin/tree/main/xiaomi-wr30u">小米原厂 mtd8/mtd9 备份文件</a></td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/hanwckf/immortalwrt-mt798x/blob/openwrt-21.02/target/linux/mediatek/files-5.4/arch/arm64/boot/dts/mediatek/mt7981-xiaomi-mi-router-wr30u-stock.dts">immortalwrt-mt798x stock</a></td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/openwrt/openwrt/blob/main/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-stock.dts">OpenWrt stock</a></td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/immortalwrt/immortalwrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-stock.dts">immortalwrt stock</a></td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/x-wrt/x-wrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-stock.dts">X-Wrt stock</a></td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/hanwckf/immortalwrt-mt798x/blob/openwrt-21.02/target/linux/mediatek/files-5.4/arch/arm64/boot/dts/mediatek/mt7981-xiaomi-mi-router-wr30u-112m.dts">immortalwrt-mt798x 112m</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://www.right.com.cn/forum/thread-8297881-1-1.html">GL.iNet by 237176253</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/x-wrt/x-wrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-112m-nmbm.dts">X-Wrt 112m nmbm</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/openwrt/openwrt/blob/main/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-112m-nmbm.dts">OpenWrt 112m nmbm</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/immortalwrt/immortalwrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-112m-nmbm.dts">immortalwrt 112m nmbm</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/x-wrt/x-wrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-112m-nmbm.dts">X-Wrt 112m nmbm</a></td>
<td>×</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://www.right.com.cn/forum/thread-8284824-1-1.html">QWRT</a></td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td><a href="https://github.com/openwrt/openwrt/blob/main/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-ubootmod.dts">OpenWrt ubootmod</a></td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/immortalwrt/immortalwrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-ubootmod.dts">immortalwrt ubootmod</a></td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td><a href="https://github.com/x-wrt/x-wrt/blob/master/target/linux/mediatek/dts/mt7981b-xiaomi-mi-router-wr30u-ubootmod.dts">X-Wrt ubootmod</a></td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="固件">固件<a class="headerlink" href="#固件" title="Permanent link">&para;</a></h4>
<p><strong>以下固件均使用闭源无线驱动，无法和官方 openwrt 组 mesh</strong>
QWRT
<a href="https://www.right.com.cn/forum/thread-8284824-1-1.html">【新提醒】潘多拉 QWRT MT7981 小米 WR30U 联通版 高性能闭源固件发布（原生无线配置）-OPENWRT 专版 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)</a></p>
<p>X-Wrt
<a href="https://x-wrt.com/">X-Wrt, for IoT, a custom Distribution for OpenWrt</a></p>
<p>hanwckf's immortalwrt
<a href="https://github.com/hanwckf/immortalwrt-mt798x">hanwckf/immortalwrt-mt798x (github.com)</a>
<a href="https://cmi.hanwckf.top/p/immortalwrt-mt798x/">immortalwrt-mt798x 项目介绍 (hanwckf.top)</a></p>
<h4 id="官方教程">官方教程<a class="headerlink" href="#官方教程" title="Permanent link">&para;</a></h4>
<p>官方教程<a href="https://git.openwrt.org/?p=openwrt/openwrt.git;a=commit;h=54dc1cde48a47a3ebf4c182916802f33786f000a">git.openwrt.org Git - openwrt/openwrt.git/commit</a></p>
<p>stock 固件 uboot</p>
<ul>
<li>原厂解锁 ssh</li>
<li>刷 initramfs-factory.ubi (ubiformat)</li>
<li>使用 squashfs-sysupgrade.bin 升级（命令行 sysupgrade 或者 luci）
stock uboot 分区布局，ubi 部分很小，只有 34MB(128MB flash)</li>
</ul>
<p>改版 uboot
可以使用改版 uboot 分区格式（不是使用改版 bootloader，比如 breed。而且神奇的是 uboot 居然也支持网页上传固件功能）</p>
<ul>
<li>刷 ubootmod-initramfs-factory.ubi</li>
<li>kmod-mtd-rw</li>
<li>Format ubi and create new ubootenv volume</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>ubidetach -p /dev/mtd8; ubiformat /dev/mtd8 -y; ubiattach -p /dev/mtd8  
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>   ubimkvol /dev/ubi0 -n 0 -N ubootenv -s 128KiB  
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>   ubimkvol /dev/ubi0 -n 1 -N ubootenv2 -s 128KiB
</span></code></pre></div>
<ul>
<li>Flash Openwrt U-Boot<ul>
<li>BL2 是 ARM 设备关于多级 Bootloader 中的一级。</li>
<li>FIP 包含 uboot</li>
</ul>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>mtd write /tmp/ubootmod-preloader.bin BL2  
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a> mtd write /tmp/ubootmod-bl31-uboot.fip FIP
</span></code></pre></div>
<ul>
<li>sysupgrade</li>
</ul>
<p>恢复原厂固件</p>
<ul>
<li>sysupgrade -F -n /tmp/ubootmod-initramfs-recovery.itb。系统会重启进入 openwrt initramfs 系统</li>
<li>Format ubi and Nvram<br />
<code>ubidetach -p /dev/mtd8; ubiformat /dev/mtd8 -y; ubiattach -p /dev/mtd8  
   mtd erase Nvram</code>
   - Flash stock U-Boot and ubi<br />
<code>mtd write /tmp/BL2.bin BL2  
   mtd write /tmp/FIP.bin FIP  
   mtd write /tmp/ubi.bin ubi</code></li>
<li>刷回备份 mtd8（原厂固件）
   Just run command: <code>ubiformat /dev/mtd8 -y -f /tmp/ubi.bin</code></li>
</ul>
<h3 id="其它-7981">其它 7981<a class="headerlink" href="#其它-7981" title="Permanent link">&para;</a></h3>
<p>做工果然还是有区别的，ax6s wifi6 160Mhz 极限可以跑到1.56Gbits/sec。而 jcg q30 pro 最高跑到 1.2G。</p>
<blockquote>
<p>无线规格是 ax3000，支持 160Mhz 频宽的 Wi-Fi，相比红米 ax6s 的 4x4mimo 80Mhz 频宽，目前 2*2 mimo 160Mhz 还是更实用，能让近几年的安卓、Windows 设备都能达到 2400Mbps 的连接速率；</p>
</blockquote>
<p>ax6s 我成功开启了 160Mhz，虽然开始确实遇到了开启后，没有 wifi 信号的问题。但是试了：国家码改成 AU，60 channel 后就成功了（36 试了开不开）。在 wifi analyzer 和 wifi man 手机软件中看确实是 60 开始的 80 Mhz。但是笔记本连接确实能协商到 2400，并且 iperf3 测速上传也能到 1.5G。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>$ iperf3.exe -c ax6s.op2 -P 2
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>- - - - - - - - - - - - - - - - - - - - - - - - -
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>[ ID] Interval           Transfer     Bitrate
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>[  5]   0.00-10.00  sec   949 MBytes   796 Mbits/sec                  sender
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>[  5]   0.00-10.01  sec   949 MBytes   796 Mbits/sec                  receiver
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>[  7]   0.00-10.00  sec   911 MBytes   764 Mbits/sec                  sender
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>[  7]   0.00-10.01  sec   911 MBytes   764 Mbits/sec                  receiver
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>[SUM]   0.00-10.00  sec  1.82 GBytes  1.56 Gbits/sec                  sender
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>[SUM]   0.00-10.01  sec  1.82 GBytes  1.56 Gbits/sec                  receiver
</span></code></pre></div>
<p>主线op：<a href="https://firmware-selector.openwrt.org/?version=23.05.3&amp;target=mediatek%2Ffilogic&amp;id=jcg_q30-pro">OpenWrt Firmware Selector</a>
JCG Q30 Pro (OpenWrt U-Boot layout)) <a href="https://firmware-selector.immortalwrt.org/?version=23.05.2&amp;target=mediatek%2Ffilogic&amp;id=jcg_q30">ImmortalWrt Firmware Selector</a>
JCG Q30 Pro (custom U-Boot layout)<a href="https://firmware-selector.immortalwrt.org/?version=23.05.2&amp;target=mediatek%2Ffilogic&amp;id=jcg_q30">ImmortalWrt Firmware Selector</a></p>
<p>CMCC RAX3000M：<a href="https://blog.sh1mar.in/post/cmcc-rax3000m/">在中国移动 RAX3000M 上使用主线 openwrt 记录 - sh1marin's blog</a></p>
<ul>
<li>惊现 cyy</li>
<li>有 USB3.0</li>
<li>大小比 jcg 略小点，但是比 jcg 厚一点</li>
</ul>
<p>H3C NX30 Pro</p>
<p>小米 AX3000T：天线可以折叠，外形比较好看。</p>
<h3 id="jcg-q30-pro">JCG Q30 PRO<a class="headerlink" href="#jcg-q30-pro" title="Permanent link">&para;</a></h3>
<ul>
<li>分原厂 512 MB 内存版，和 256 MB 内存版</li>
<li>拆机版：<a href="https://mary.kevinmx.top/default/JCG-Q30-Pro.html">捷稀 JCG Q30 Pro 刷机说明 - 拆机版 - Re: MX 的自留地 (kevinmx.top)</a></li>
<li>免拆版：<a href="https://mary.kevinmx.top/default/JCG-Q30-Pro-Neo.html">捷稀 JCG Q30 Pro 刷机说明 - 免拆版 - Re: MX 的自留地 (kevinmx.top)</a></li>
<li>官方：<a href="https://openwrt.org/toh/jcg/q30_pro">[OpenWrt Wiki] JCG Q30 Pro</a></li>
<li><a href="https://git.openwrt.org/?p=openwrt/openwrt.git;a=commit;h=626344c9926dcf2db2e10681c19aab0328fee160">git.openwrt.org Git - openwrt/openwrt.git/commit</a></li>
</ul>
<p>immortalwrt 支持</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>**Commit:** 2084a1a31c8faf1adc6b170f3f15fc0660a52ec4  
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>**Parents:** 1fabb1e2f5c79ddb8038e9675965cb41054139fc  
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>**Author:** Tianling Shen &lt;[cnsztl@immortalwrt.org](mailto:cnsztl@immortalwrt.org)&gt;  
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>**Author Date:** Mon Jun 26 2023 21:00:49 GMT+0800 (China Standard Time)  
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>**Committer:** Tianling Shen &lt;[cnsztl@immortalwrt.org](mailto:cnsztl@immortalwrt.org)&gt;  
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>**Committer Date:** Mon Jun 26 2023 21:02:02 GMT+0800 (China Standard Time)  
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>mediatek: add JCG Q30 (Pro) support  
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>Signed-off-by: Tianling Shen &lt;cnsztl@immortalwrt.org&gt;
</span></code></pre></div>
<p>主线版本</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>**Commit:** 626344c9926dcf2db2e10681c19aab0328fee160  
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>**Parents:** b42c5272286ee248c698cc2cfac88df1bf51cbe3  
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>**Author:** Chukun Pan &lt;[amadeus@jmu.edu.cn](mailto:amadeus@jmu.edu.cn)&gt;  
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>**Author Date:** Fri Jun 16 2023 23:16:30 GMT+0800 (China Standard Time)  
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>**Committer:** Hauke Mehrtens &lt;[hauke@hauke-m.de](mailto:hauke@hauke-m.de)&gt;  
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>**Committer Date:** Sun Nov 19 2023 23:52:16 GMT+0800 (China Standard Time)  
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>mediatek: filogic: add JCG Q30 PRO support  
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>Hardware specification:  
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>  SoC: MediaTek MT7981B 2x A53  
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>  Flash: Winbond 128MB  
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>  RAM: DDR3 256MB  
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>  Ethernet: 4x 10/100/1000 Mbps  
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>  Switch: MediaTek MT7531AE  
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>  WiFi: MediaTek MT7976C  
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>  Button: Reset  
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>  Power: DC 12V 1A  
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>Flash instructions:  
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>  1. Connect to your PC via the Gigabit port of the router,  
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>     set a static ip on the ethernet interface of your PC.  
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>     (ip 192.168.1.254, gateway 192.168.1.1)  
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>  2. Attach UART, pause at u-boot menu.  
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>  3. Select &quot;Upgrade ATF BL2&quot;, then use preloader.bin  
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>  4. Select &quot;Upgrade ATF FIP&quot;, then use bl31-uboot.fip  
</span><span id="__span-35-27"><a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>  5. Download the initramfs image, and type &quot;reset&quot;,  
</span><span id="__span-35-28"><a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>     waiting for tftp recovery to complete.  
</span><span id="__span-35-29"><a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>  6. After openwrt boots up, perform sysupgrade.  
</span><span id="__span-35-30"><a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a>
</span><span id="__span-35-31"><a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a>Note:  
</span><span id="__span-35-32"><a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a>  1. Since NMBM is disabled, we must back up all partitions.  
</span><span id="__span-35-33"><a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a>  2. Although we can upgrade new firmware in the stock firmware,  
</span><span id="__span-35-34"><a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a>     we need the special fit image signature of MediaTek and  
</span><span id="__span-35-35"><a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a>     dual boot (hack kernel) to make u-boot boot it. So just  
</span><span id="__span-35-36"><a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a>     abandon these hacks and flash it via the serial port.  
</span><span id="__span-35-37"><a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a>
</span><span id="__span-35-38"><a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a>Signed-off-by: Chukun Pan &lt;amadeus@jmu.edu.cn&gt;
</span></code></pre></div>
<p>immortal 删除了 custom layout</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>**Commit:** 8593c213b018e380e465f9967225abc31b5b3e75  
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>**Parents:** a97a7d457528bdc6b3c325858edadbec7e7b8641  
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>**Author:** Tianling Shen &lt;[cnsztl@immortalwrt.org](mailto:cnsztl@immortalwrt.org)&gt;  
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>**Author Date:** Sat Jan 06 2024 14:24:12 GMT+0800 (China Standard Time)  
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>**Committer:** Tianling Shen &lt;[cnsztl@immortalwrt.org](mailto:cnsztl@immortalwrt.org)&gt;  
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>**Committer Date:** Thu Jan 11 2024 11:02:29 GMT+0800 (China Standard Time)  
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>mediatek: remove custom layout for JCG Q30  
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>Since the mainline implementation has been accepted by upstream,  
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>it doesn&#39;t make sense to keep these hacks. People are also confused  
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>with these &quot;custom layouts&quot;.  
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>Signed-off-by: Tianling Shen &lt;cnsztl@immortalwrt.org&gt;
</span></code></pre></div>
<ul>
<li>主线 op 没有免拆刷机方法（刷过渡包）吗？<ul>
<li>看来确实没有，来自主线 commit msg：Although we can upgrade new firmware in the stock firmware, we need the special fit image signature of MediaTek and dual boot (hack kernel) to make u-boot boot it. So just abandon these hacks and flash it via the serial port.</li>
</ul>
</li>
<li>可以先用 237 过渡固件刷好 uboot 后，直接通过 WebUI 上传主线 op sysupgrade文件吗（主线只有sysupgrade没有factory）</li>
<li><strong>可以刷好任意一个 openwrt 版本后，ssh 上去后，通过 mtd 刷写主线 op 吗</strong>，需要修改哪些东西（我之前因为操作不当把一个 wr30u 变砖了，即使 TTL 进入了 uboot，结果网络不通，没法通过 tftp 恢复）</li>
<li>immortalwrt 两个版本（OpenWrt U-Boot layout 和 custom U-Boot layout）区别是什么<ul>
<li>Tianling 版本的开启了 nmbm 功能，主线的没有。flash 分区不一样</li>
</ul>
</li>
<li>为什么刷天灵版本 uboot 不用修改 BL2（主线 op 需要升级 ATF BL2和FIP）</li>
</ul>
<p>几个一般性的问题</p>
<ul>
<li>主线的 uboot 没有 webui 的功能吗</li>
<li>很多刷机方法里的先刷 initramfs image，再 sysupgrade 的目的是为什么？为什么不直接修改 firmware 分区</li>
</ul>
<h4 id="遇到问题_1">遇到问题<a class="headerlink" href="#遇到问题_1" title="Permanent link">&para;</a></h4>
<p>5g 160MHz 无线很慢，ping 大包直接丢包。重新连接 wifi 就好了</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>$ ping 192.168.1.1 -l 2000
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>正在 Ping 192.168.1.1 具有 2000 字节的数据:
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>请求超时。
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>请求超时。
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>请求超时。
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>来自 192.168.1.1 的回复: 字节=2000 时间=3ms TTL=64
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>192.168.1.1 的 Ping 统计信息:
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>    数据包: 已发送 = 4，已接收 = 1，丢失 = 3 (75% 丢失)，
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>往返行程的估计时间(以毫秒为单位):
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>    最短 = 3ms，最长 = 3ms，平均 = 3ms
</span></code></pre></div>
<h3 id="tl-xdr6088">TL-XDR6088<a class="headerlink" href="#tl-xdr6088" title="Permanent link">&para;</a></h3>
<p>https://lwz322.github.io/2023/07/11/Infrastructure.html#:~:text=%E7%AE%97%E6%98%AF%E6%AF%94%E8%BE%83%E5%A5%BD%E7%9A%84-,XDR6088%E5%88%B7OpenWrt,-%E5%8F%AF%E4%BB%A5%E6%9F%A5%E5%88%B0%E7%9A%84</p>
<p><a href="https://shun.typlog.io/tl-xdr608x-openwrt-install">TL-XDR6088/6086 刷入官方 Openwrt/Immortalwrt - 川叶 :: 不舍昼夜 (typlog.io)</a></p>
<h4 id="debug-版本刷机">debug 版本刷机<a class="headerlink" href="#debug-版本刷机" title="Permanent link">&para;</a></h4>
<p>含固件下载地址：<a href="https://www.right.com.cn/forum/thread-8296029-1-1.html">【新提醒】XTR8488 XDR6088/6086 UPNP DHCP 跳Ping Docker 漫游 无线 刷机 官方修复固件1.3更-Tp-link无线路由器及网络设备-恩山无线论坛</a>
- 只有正式版可以刷到 debug 版本，修复版不行</p>
<p><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=8404193&amp;highlight=xdr6088">【新提醒】2024年刷XDR6088有感;——被低估的王者-Tp-link无线路由器及网络设备-恩山无线论坛</a></p>
<p>记录信息：
当前硬件版本：TL-XDR6088易展Turbo版 1.0
当前软件版本：1.0.30 Build 240327 Rel.27223</p>
<p><strong>刷机</strong></p>
<p>1.0.30 -&gt; 1.0.28 -&gt; 1.0.29 测试版(debug 版) -&gt; 上传 openwrt/immortalwrt sysupgrade.fip</p>
<p><strong>恢复官方</strong>：</p>
<p>如果我们刷完openwrt感觉不满意还可以刷回官方原厂固件。我们刷机失败，或者按着reset上电,<a href="https://www.smzdm.com/fenlei/luyouqi/">路由器</a>都会自动进入救援模式，然后就可以刷入从tplink下载的官方固件了。</p>
<h4 id="接口">接口<a class="headerlink" href="#接口" title="Permanent link">&para;</a></h4>
<p>2.5 2.5 
eth1 lan5 lan1 lan2 lan3 lan4</p>
<h3 id="cudy-tr3000-v1">cudy tr3000 v1<a class="headerlink" href="#cudy-tr3000-v1" title="Permanent link">&para;</a></h3>
<h4 id="刷-openwrt_1">刷 openwrt<a class="headerlink" href="#刷-openwrt_1" title="Permanent link">&para;</a></h4>
<p>官方提供了过渡固件（openwrt 固件，禁用了修改 fip 分区）：<a href="https://www.cudy.com/blogs/faq/openwrt-software-download">OpenWrt Software Download – Cudy</a></p>
<p>上传过渡固件即可进入一个 openwrt 系统，通过 openwrt sysupgrade 即可更新到其他版本 openwrt</p>
<p>注意事项</p>
<ul>
<li>刷官方过渡固件再刷 openwrt 不需要修改 uboot</li>
<li>hanwckf 的 uboot 没有支持，openwrt firmware selector 也只有一个布局的镜像（应该是小镜像 64MB）</li>
</ul>
<p>openwrt 还提供了一个串口刷机的方法：<a href="https://openwrt.org/toh/cudy/tr3000">[OpenWrt Wiki] Cudy TR3000 (AX3000 Travel Router)</a>
原理是 reset 进入恢复，恢复失败后会进入 uboot shell，于是可以使用 tftp 恢复 initramfs-kernel.bin</p>
<h4 id="从-openwrt-恢复为官方">从 openwrt 恢复为官方<a class="headerlink" href="#从-openwrt-恢复为官方" title="Permanent link">&para;</a></h4>
<p>官方提供了从 openwrt 刷回官方固件方法：<a href="https://www.cudy.com/blogs/faq/how-to-recovery-the-cudy-router-from-openwrt-firmware-to-cudy-official-firmware">How to Recovery the Cudy Router From OpenWRT Firmware to Cudy Official</a></p>
<ul>
<li>基于 tftp，需要一个 recover 固件。和过渡固件在一起，官方还提供了 tftp 软件和 pdf 说明。 <a href="https://drive.google.com/drive/folders/1BKVarlwlNxf7uJUtRhuMGUqeCa5KpMnj">Cudy Intermediary OpenWRT Firmware - Google 云端硬盘</a></li>
</ul>
<h3 id="ft">FT<a class="headerlink" href="#ft" title="Permanent link">&para;</a></h3>
<p><a href="https://post.smzdm.com/p/a6lr03wg/">OpenWRT 路由器快速漫游（802.11r）配置教程以及深度解析_路由器_什么值得买 (smzdm.com)</a></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>Thu Aug 17 11:31:19 2023 kern.warn kernel: [164938.908390] 7981@C13L2,MacTableInsertEntry() 1537: New Sta:2a:85:8f:ff:be:e3
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>Thu Aug 17 11:31:19 2023 kern.err kernel: [164938.915643] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>Thu Aug 17 11:31:22 2023 kern.notice kernel: [164942.301972] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>Thu Aug 17 11:31:22 2023 kern.err kernel: [164942.314678] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>Thu Aug 17 11:31:26 2023 kern.notice kernel: [164945.762095] 7981@C08L3,ap_peer_auth_req_at_idle_action() 717: AUTH - MBSS(1), Rcv AUTH seq#1, Alg=2, Status=0 from [wcid=1]2a:85:8f:ff:be:e3
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>Thu Aug 17 11:31:26 2023 kern.err kernel: [164945.774793] 7981@C14L1,FT_AuthReqHandler() 536: The MDIE is invalid(Peer MDID= 17 17, My MDID = 82 84
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>Thu Aug 17 11:31:32 2023 kern.warn kernel: [164952.375145] 7981@C01L2,wifi_sys_disconn_act() 1002:  wdev_idx=1
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>Thu Aug 17 11:31:32 2023 kern.warn kernel: [164952.381500] 7981@C13L2,MacTableDeleteEntry() 1793: Del Sta:2a:85:8f:ff:be:e3
</span></code></pre></div>
<p>客厅 r3g</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, OPEN_SYSTEM)
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authenticated
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-ASSOCIATE.indication(2a:85:8f:ff:be:e3)
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 1 notification
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: start authentication
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: unauthorizing port
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 1/4 msg of 4-Way Handshake
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (2/4 Pairwise)
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: sending 3/4 msg of 4-Way Handshake
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: received EAPOL-Key frame (4/4 Pairwise)
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>Thu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>Thu Aug 17 11:30:05 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.1X: authorizing port
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 RADIUS: starting accounting session CDB345D82723F2E1
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a>Thu Aug 17 11:30:05 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: pairwise key handshake completed (RSN)
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>Thu Aug 17 11:30:05 2023 daemon.notice hostapd: wlan1: EAPOL-4WAY-HS-COMPLETED 2a:85:8f:ff:be:e3
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a>Thu Aug 17 11:36:38 2023 daemon.notice hostapd: wlan1: AP-STA-DISCONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a>Thu Aug 17 11:36:38 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: disassociated due to inactivity
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a>Thu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DISASSOCIATE.indication(2a:85:8f:ff:be:e3, 4)
</span><span id="__span-39-25"><a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a>Thu Aug 17 11:36:38 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span><span id="__span-39-26"><a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a>Thu Aug 17 11:36:39 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: deauthenticated due to inactivity (timer DEAUTH/REMOVE)
</span><span id="__span-39-27"><a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a>Thu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DEAUTHENTICATE.indication(2a:85:8f:ff:be:e3, 2)
</span><span id="__span-39-28"><a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a>Thu Aug 17 11:36:39 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-DELETEKEYS.request(2a:85:8f:ff:be:e3)
</span></code></pre></div>
<p>op3(ax6s)</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: authentication OK (FT)
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-AUTHENTICATE.indication(2a:85:8f:ff:be:e3, FT)
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: association OK (aid 1)
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>Thu Aug 17 11:30:57 2023 daemon.info hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: associated (aid 1)
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>Thu Aug 17 11:30:57 2023 daemon.notice hostapd: wlan1: AP-STA-CONNECTED 2a:85:8f:ff:be:e3
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 MLME: MLME-REASSOCIATE.indication(2a:85:8f:ff:be:e3)
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 IEEE 802.11: binding station to interface &#39;wlan1&#39;
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: event 6 notification
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>Thu Aug 17 11:30:57 2023 daemon.debug hostapd: wlan1: STA 2a:85:8f:ff:be:e3 WPA: FT authentication already completed - do not start 4-way handshake
</span></code></pre></div>
<h4 id="其它">其它<a class="headerlink" href="#其它" title="Permanent link">&para;</a></h4>
<p>原厂系统
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141433.png" />
支持的功能
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141449.png" /></p>
<p>从咸鱼上买的，路由器系统里可以看到 1 月份的日志。
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141342.png" /></p>
<p>uboot 控制台
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141529.png" /></p>
<p><img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141559.png" /></p>
<p>webui 刷机时串口输出
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230815141615.png" /></p>
<h2 id="硬件性能测试-wg-带宽">硬件性能测试 (wg 带宽)<a class="headerlink" href="#硬件性能测试-wg-带宽" title="Permanent link">&para;</a></h2>
<h3 id="king3399">king3399<a class="headerlink" href="#king3399" title="Permanent link">&para;</a></h3>
<p>未加密</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>root@op1 ➜  ~ iperf3 -c 114.214.236.90
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>[  5]   0.00-10.00  sec  1.10 GBytes   943 Mbits/sec   70             sender
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>[  5]   0.00-10.05  sec  1.09 GBytes   936 Mbits/sec                  receiver
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>root@op1 ➜  ~ iperf3 -c king6.yfycloud.top
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>[  5]   0.00-10.00  sec  1.08 GBytes   924 Mbits/sec   29             sender
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>[  5]   0.00-10.04  sec  1.07 GBytes   918 Mbits/sec                  receiver
</span></code></pre></div>
<p>wg</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>➜  ~ iperf3 -c king
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>[  5]   0.00-10.00  sec  1.04 GBytes   893 Mbits/sec  70559             sender
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>[  5]   0.00-10.04  sec  1.04 GBytes   887 Mbits/sec                  receiver
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>➜  ~ iperf3 -c king -R
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>[  5]   0.00-10.04  sec   691 MBytes   577 Mbits/sec    2             sender
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>[  5]   0.00-10.00  sec   688 MBytes   577 Mbits/sec                  receiver
</span></code></pre></div>
<h3 id="p2w">p2w<a class="headerlink" href="#p2w" title="Permanent link">&para;</a></h3>
<p>未加密，居然跑不满千兆（连接中间通过了一个 usb 千兆网卡）</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>➜  ~ iperf3 -c p2w
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>[  5]   0.00-10.00  sec   754 MBytes   633 Mbits/sec  344             sender
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>[  5]   0.00-10.00  sec   752 MBytes   630 Mbits/sec                  receiver
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>➜  ~ iperf3 -c p2w -R
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>[  5]   0.00-10.01  sec   902 MBytes   757 Mbits/sec  738             sender
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>[  5]   0.00-10.00  sec   902 MBytes   757 Mbits/sec                  receiver
</span></code></pre></div>
<h3 id="ax6s_1">ax6s<a class="headerlink" href="#ax6s_1" title="Permanent link">&para;</a></h3>
<p>未加密（中间是一个 usb 千兆网卡）</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>(base) yfy@Tianyi ➜  ~ iperf3 -c 192.168.36.2
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>[  5]   0.00-10.00  sec  1.10 GBytes   942 Mbits/sec    0             sender
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>[  5]   0.00-10.01  sec  1.09 GBytes   939 Mbits/sec                  receiver
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>(base) yfy@Tianyi ➜  ~ iperf3 -c 192.168.36.2 -R
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>[  5]   0.00-10.00  sec  1.09 GBytes   940 Mbits/sec    0             sender
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>[  5]   0.00-10.00  sec  1.09 GBytes   939 Mbits/sec                  receiver
</span></code></pre></div>
<p>wg
复用之前的 home 到学校数据
baseline：ipv6 直连</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>home下载
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>[SUM]   0.00-10.00  sec   798 MBytes   669 Mbits/sec  468             sender
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>[SUM]   0.00-10.05  sec   786 MBytes   656 Mbits/sec                  receiver
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>home上传
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>[SUM]   0.00-10.06  sec   925 MBytes   771 Mbits/sec  1185             sender
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>[SUM]   0.00-10.00  sec   918 MBytes   770 Mbits/sec                  receiver
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>➜  ~ iperf3 -c op3
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>[  5]   0.00-10.00  sec   163 MBytes   137 Mbits/sec    0             sender
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>[  5]   0.00-10.05  sec   161 MBytes   134 Mbits/sec                  receiver
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>➜  ~ iperf3 -c op3 -P 5
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>[SUM]   0.00-10.00  sec   537 MBytes   450 Mbits/sec  302             sender
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>[SUM]   0.00-10.06  sec   525 MBytes   438 Mbits/sec                  receiver
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>➜  ~ iperf3 -c op3 -R
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>[ ID] Interval           Transfer     Bitrate         Retr
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>[  5]   0.00-10.05  sec   235 MBytes   196 Mbits/sec  170             sender
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>[  5]   0.00-10.00  sec   234 MBytes   196 Mbits/sec                  receiver
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a>➜  ~ iperf3 -c op3 -R -P 5
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>[SUM]   0.00-10.05  sec   504 MBytes   421 Mbits/sec    0             sender
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a>[SUM]   0.00-10.00  sec   497 MBytes   417 Mbits/sec                  receiver
</span></code></pre></div>
<p>恐怖的 CPU 占用
<img alt="" src="https://raw.githubusercontent.com/TheRainstorm/.image-bed/main/20230810160001.png" /></p>







  
  




  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../2022-02-13-openwrt%E7%BC%96%E8%AF%91/" class="md-footer__link md-footer__link--prev" aria-label="上一页: openwrt 编译">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                openwrt 编译
              </div>
            </div>
          </a>
        
        
          
          <a href="../../14/2022-02-14-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E8%87%AA%E7%94%B1/" class="md-footer__link md-footer__link--next" aria-label="下一页: 如何实现网络自由">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                如何实现网络自由
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/TheRainstorm" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.footer", "content.code.copy", "toc.follow", "toc.integrate"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>